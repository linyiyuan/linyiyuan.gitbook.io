{"compress":true,"commitItems":[["3fcb4490-86f9-45c6-98c5-0b2edceebf38",1567994096331,"",[[1567994043694,["sirui-php@DESKTOP-PSVFMK8",[[1,0,"# 垃圾回收机制\n\n\n\n"]],[0,0],[11,11]]],[1568014661838,["sirui-php@DESKTOP-PSVFMK8",[[-1,0,"# 垃圾回收机制"]],[0,8],[0,0]]],[1568014711245,["sirui-php@DESKTOP-PSVFMK8",[[1,0,"#"]],[0,0],[1,1]]],[1568014711447,["sirui-php@DESKTOP-PSVFMK8",[[1,0,"#"]],[1,1],[2,2]]],[1568014716045,["sirui-php@DESKTOP-PSVFMK8",[[1,2," ## 引用计数基本知识"]],[2,2],[14,14]]],[1568014722234,["sirui-php@DESKTOP-PSVFMK8",[[-1,0,"## #"]],[0,3],[0,0]]],[1568014722258,["sirui-php@DESKTOP-PSVFMK8",[[1,0,"="]],[0,0],[1,1]]],[1568014725890,["sirui-php@DESKTOP-PSVFMK8",[[-1,0,"=# 引用计数基本知识"]],[1,1],[0,0]]],[1568014727669,["sirui-php@DESKTOP-PSVFMK8",[[1,0,"# 前言"]],[0,0],[4,4]]],[1568014727955,["sirui-php@DESKTOP-PSVFMK8",[[1,8,"\n"]],[4,4],[5,5]]],[1568014738846,["sirui-php@DESKTOP-PSVFMK8",[[1,5,"在认识PHP垃圾回收机制之前先然我"]],[5,5],[22,22]]],[1568014739186,["sirui-php@DESKTOP-PSVFMK8",[[-1,20,"然我"]],[22,22],[20,20]]],[1568014742462,["sirui-php@DESKTOP-PSVFMK8",[[1,20,"让我来"]],[20,20],[23,23]]],[1568014743115,["sirui-php@DESKTOP-PSVFMK8",[[-1,21,"我来"]],[23,23],[21,21]]],[1568014750032,["sirui-php@DESKTOP-PSVFMK8",[[1,21,"我们来学习下引用"]],[21,21],[29,29]]],[1568014750466,["sirui-php@DESKTOP-PSVFMK8",[[-1,27,"引用"]],[29,29],[27,27]]],[1568014751043,["sirui-php@DESKTOP-PSVFMK8",[[1,27,"``"]],[27,27],[29,29]]],[1568014751772,["sirui-php@DESKTOP-PSVFMK8",[[1,27," "]],[27,27],[28,28]]],[1568014756175,["sirui-php@DESKTOP-PSVFMK8",[[1,29,"引用计算"]],[29,29],[33,33]]],[1568014757050,["sirui-php@DESKTOP-PSVFMK8",[[-1,32,"算"]],[33,33],[32,32]]],[1568014758213,["sirui-php@DESKTOP-PSVFMK8",[[1,32,"数目、"]],[32,32],[35,35]]],[1568014761121,["sirui-php@DESKTOP-PSVFMK8",[[-1,33,"目、"]],[35,35],[33,33]]],[1568014777388,["sirui-php@DESKTOP-PSVFMK8",[[1,34," 的基本知识，学习完这个"]],[34,34],[46,46]]],[1568014778884,["sirui-php@DESKTOP-PSVFMK8",[[-1,43,"完这个"]],[46,46],[43,43]]],[1568014781470,["sirui-php@DESKTOP-PSVFMK8",[[1,43," ··"]],[43,43],[46,46]]],[1568014782035,["sirui-php@DESKTOP-PSVFMK8",[[-1,44,"··"]],[46,46],[44,44]]],[1568014782575,["sirui-php@DESKTOP-PSVFMK8",[[1,44,"··"]],[44,44],[46,46]]],[1568014783822,["sirui-php@DESKTOP-PSVFMK8",[[-1,43," ··"]],[46,46],[43,43]]],[1568014784806,["sirui-php@DESKTOP-PSVFMK8",[[1,43," ``"]],[43,43],[46,46]]],[1568014787292,["sirui-php@DESKTOP-PSVFMK8",[[1,45,"引用计数"]],[45,45],[49,49]]],[1568014797488,["sirui-php@DESKTOP-PSVFMK8",[[1,50," 有助于我们了解PHP代码"]],[50,50],[63,63]]],[1568014798604,["sirui-php@DESKTOP-PSVFMK8",[[-1,58,"PHP代码"]],[63,63],[58,58]]],[1568014802568,["sirui-php@DESKTOP-PSVFMK8",[[1,58,"垃圾回收机制的原理"]],[58,58],[67,67]]],[1568014809662,["sirui-php@DESKTOP-PSVFMK8",[[1,67,"以及php底层的一些知识"]],[67,67],[79,79]]],[1568014811230,["sirui-php@DESKTOP-PSVFMK8",[[-1,74,"的一些知识"]],[79,79],[74,74]]],[1568014818613,["sirui-php@DESKTOP-PSVFMK8",[[1,74,"，话不多说，下面开始介绍"]],[74,74],[86,86]]],[1568014819259,["sirui-php@DESKTOP-PSVFMK8",[[1,90,"\n"]],[86,86],[87,87]]],[1568014819842,["sirui-php@DESKTOP-PSVFMK8",[[1,91,"\n"]],[87,87],[88,88]]],[1568014821416,["sirui-php@DESKTOP-PSVFMK8",[[1,88,"#"]],[88,88],[89,89]]],[1568014821955,["sirui-php@DESKTOP-PSVFMK8",[[-1,88,"#"]],[89,89],[88,88]]],[1568014825363,["sirui-php@DESKTOP-PSVFMK8",[[1,88,"# ## 引用计数基本知识"]],[88,88],[101,101]]],[1568014827156,["sirui-php@DESKTOP-PSVFMK8",[[-1,90,"## "]],[88,91],[88,88]]],[1568014830133,["sirui-php@DESKTOP-PSVFMK8",[[1,102,"\n"]],[98,98],[99,99]]],[1568014919941,["sirui-php@DESKTOP-PSVFMK8",[[1,99,"子"]],[99,99],[100,100]]],[1568014920446,["sirui-php@DESKTOP-PSVFMK8",[[-1,99,"子"]],[100,100],[99,99]]],[1568014921453,["sirui-php@DESKTOP-PSVFMK8",[[1,99,"在介绍"]],[99,99],[102,102]]],[1568014925085,["sirui-php@DESKTOP-PSVFMK8",[[1,102,"引用计数之前"]],[102,102],[108,108]]],[1568014927613,["sirui-php@DESKTOP-PSVFMK8",[[1,89,"#"]],[89,89],[90,90]]],[1568014929236,["sirui-php@DESKTOP-PSVFMK8",[[1,0,"#"]],[1,1],[2,2]]],[1568014944798,["sirui-php@DESKTOP-PSVFMK8",[[1,110,"，我们翻阅过PHP的官方手册，在写"]],[110,110],[127,127]]],[1568014944998,["sirui-php@DESKTOP-PSVFMK8",[[-1,126,"写"]],[127,127],[126,126]]],[1568014952559,["sirui-php@DESKTOP-PSVFMK8",[[1,126,"测试代码的时候发现运行结果与线上"]],[126,126],[142,142]]],[1568014969435,["sirui-php@DESKTOP-PSVFMK8",[[-1,140,"线上"]],[142,142],[140,140]]],[1568014982637,["sirui-php@DESKTOP-PSVFMK8",[[1,140,"官方手册所写的不符，翻阅"]],[140,140],[152,152]]],[1568014989948,["sirui-php@DESKTOP-PSVFMK8",[[1,152,"相关资料之后发现官方手册"]],[152,152],[164,164]]],[1568015043117,["sirui-php@DESKTOP-PSVFMK8",[[-1,162,"手册"]],[164,164],[162,162]]],[1568015043430,["sirui-php@DESKTOP-PSVFMK8",[[-1,160,"官方"]],[162,162],[160,160]]],[1568015064078,["sirui-php@DESKTOP-PSVFMK8",[[1,160,"是官方手册还停留在php5.x的版本上，而我本地的环境已经是"]],[160,160],[190,190]]],[1568015064666,["sirui-php@DESKTOP-PSVFMK8",[[-1,187,"已经是"]],[190,190],[187,187]]],[1568015067155,["sirui-php@DESKTOP-PSVFMK8",[[1,187,"是PHP6."]],[187,187],[193,193]]],[1568015067650,["sirui-php@DESKTOP-PSVFMK8",[[-1,191,"6."]],[193,193],[191,191]]],[1568015068004,["sirui-php@DESKTOP-PSVFMK8",[[1,191,"."]],[191,191],[192,192]]],[1568015068891,["sirui-php@DESKTOP-PSVFMK8",[[-1,191,"."]],[192,192],[191,191]]],[1568015070215,["sirui-php@DESKTOP-PSVFMK8",[[1,191,"7.3"]],[191,191],[194,194]]],[1568015072516,["sirui-php@DESKTOP-PSVFMK8",[[-1,169,"php"],[1,172,"P"]],[169,172],[170,170]]],[1568015072671,["sirui-php@DESKTOP-PSVFMK8",[[1,170,"H"]],[170,170],[171,171]]],[1568015079503,["sirui-php@DESKTOP-PSVFMK8",[[1,193,",所以倒置"]],[193,193],[198,198]]],[1568015088547,["sirui-php@DESKTOP-PSVFMK8",[[-1,196,"倒置"]],[198,198],[196,196]]],[1568015102173,["sirui-php@DESKTOP-PSVFMK8",[[1,196,"导致代码结果与官方手册不符，"]],[196,196],[210,210]]],[1568015104168,["sirui-php@DESKTOP-PSVFMK8",[[1,210,"这个"]],[210,210],[212,212]]],[1568015104538,["sirui-php@DESKTOP-PSVFMK8",[[-1,210,"这个"]],[212,212],[210,210]]],[1568015106269,["sirui-php@DESKTOP-PSVFMK8",[[1,210,"关于这个"]],[210,210],[214,214]]],[1568015107284,["sirui-php@DESKTOP-PSVFMK8",[[-1,212,"这个"]],[214,214],[212,212]]],[1568015137968,["sirui-php@DESKTOP-PSVFMK8",[[1,212,"为什么不符合，在下文会详细说明，并"]],[212,212],[229,229]]],[1568015138428,["sirui-php@DESKTOP-PSVFMK8",[[-1,227,"，并"]],[229,229],[227,227]]],[1568015146494,["sirui-php@DESKTOP-PSVFMK8",[[1,227,"，并且会说明5.X"]],[227,227],[236,236]]],[1568015147187,["sirui-php@DESKTOP-PSVFMK8",[[-1,235,"X"]],[236,236],[235,235]]],[1568015154997,["sirui-php@DESKTOP-PSVFMK8",[[1,235,"x版本与7.*版本"]],[235,235],[244,244]]],[1568015155718,["sirui-php@DESKTOP-PSVFMK8",[[-1,241,"*版本"]],[244,244],[241,241]]],[1568015163074,["sirui-php@DESKTOP-PSVFMK8",[[1,241,"x版本的差异性"]],[241,241],[248,248]]],[1568015171013,["sirui-php@DESKTOP-PSVFMK8",[[1,233,"引用计数在PHP"]],[233,233],[241,241]]],[1568015173701,["sirui-php@DESKTOP-PSVFMK8",[[1,247,"PHP"]],[247,247],[250,250]]],[1568015176611,["sirui-php@DESKTOP-PSVFMK8",[[1,263,"\n"]],[259,259],[260,260]]],[1568015177027,["sirui-php@DESKTOP-PSVFMK8",[[1,264,"\n"]],[260,260],[261,261]]],[1568015179307,["sirui-php@DESKTOP-PSVFMK8",[[1,265,"\n"]],[261,261],[262,262]]],[1568015179524,["sirui-php@DESKTOP-PSVFMK8",[[1,266,"\n"]],[262,262],[263,263]]],[1568015182637,["sirui-php@DESKTOP-PSVFMK8",[[1,267,"\n"]],[260,260],[261,261]]],[1568015182971,["sirui-php@DESKTOP-PSVFMK8",[[1,268,"\n"]],[261,261],[262,262]]],[1568015186220,["sirui-php@DESKTOP-PSVFMK8",[[1,259,"。"]],[259,259],[260,260]]],[1568015242317,["sirui-php@DESKTOP-PSVFMK8",[[1,262,"首先我们先来了解一下``"]],[262,262],[274,274]]],[1568015244966,["sirui-php@DESKTOP-PSVFMK8",[[1,273,"引用计算"]],[273,273],[277,277]]],[1568015245643,["sirui-php@DESKTOP-PSVFMK8",[[-1,275,"计算"]],[277,277],[275,275]]],[1568015246697,["sirui-php@DESKTOP-PSVFMK8",[[1,275,"计数"]],[275,275],[277,277]]],[1568015267795,["sirui-php@DESKTOP-PSVFMK8",[[1,278,"，引用官方文档的一段话 每个php变量存在一个叫\"zval\"的变量容器中。一个zval变量容器，除了包含变量的类型和值，还包括两个字节的额外信息。第一个是\"is_ref\"，是个bool值，用来标识这个变量是否是属于引用集合(reference set)。通过这个字节，php引擎才能把普通变量和引用变量区分开来，由于php允许用户通过使用&来使用自定义引用，zval变量容器中还有一个内部引用计数机制，来优化内存使用。第二个额外字节是\"refcount\"，用以表示指向这个zval变量容器的变量(也称符号即symbol)个数。所有的符号存在一个符号表中，其中每个符号都有作用域(scope)，那些主脚本(比如：通过浏览器请求的的脚本)和每个函数或者方法也都有作用域。"]],[278,278],[611,611]]],[1568015282147,["sirui-php@DESKTOP-PSVFMK8",[[-1,315,"一个zval变量容器，"]],[315,326],[315,315]]],[1568015283616,["sirui-php@DESKTOP-PSVFMK8",[[1,315,"容器"]],[315,315],[317,317]]],[1568015295515,["sirui-php@DESKTOP-PSVFMK8",[[-1,532,"所有的符号存在一个符号表中，其中每个符号都有作用域(scope)，那些主脚本(比如：通过浏览器请求的的脚本)和每个函数或者方法也都有作用域。\n"]],[533,603],[532,532]]],[1568015342731,["sirui-php@DESKTOP-PSVFMK8",[[-1,101,"在介绍引用计数之前，我们翻阅过PHP的官方手册，在测试代码的时候发现运行结果与官方手册所写的不符，翻阅相关资料之后发现是官方手册还停留在PH5.x的版本上，而我本地的环境是PHP7.3,所以导致代码结果与官方手册不符，关于为什么不符合，在下文会详细说明，并且会说明引用计数在PHP5.x版本与PHP7.x版本的差异性。"]],[101,260],[101,101]]],[1568015344221,["sirui-php@DESKTOP-PSVFMK8",[[-1,76,"话不多说，下面开始介绍\n"],[1,88,"在介绍引用计数之前，我们翻阅过PHP的官方手册，在测试代码的时候发现运行结果与官方手册所写的不符，翻阅相关资料之后发现是官方手册还停留在PH5.x的版本上，而我本地的环境是PHP7.3,所以导致代码结果与官方手册不符，关于为什么不符合，在下文会详细说明，并且会说明引用计数在PHP5.x版本与PHP7.x版本的差异性。"]],[76,88],[235,235]]],[1568015347603,["sirui-php@DESKTOP-PSVFMK8",[[-1,87,"们"]],[88,88],[87,87]]],[1568015348921,["sirui-php@DESKTOP-PSVFMK8",[[1,87,"曾"]],[87,87],[88,88]]],[1568015357282,["sirui-php@DESKTOP-PSVFMK8",[[-1,249,"\n"]],[249,249],[248,248]]],[1568015357429,["sirui-php@DESKTOP-PSVFMK8",[[-1,248,"\n"]],[248,248],[247,247]]],[1568015358867,["sirui-php@DESKTOP-PSVFMK8",[[1,236,"\n"]],[236,236],[237,237]]],[1568015359202,["sirui-php@DESKTOP-PSVFMK8",[[1,237,"\n"]],[237,237],[238,238]]],[1568015548526,["sirui-php@DESKTOP-PSVFMK8",[[1,250,"\n"]],[249,249],[250,250]]],[1568016169986,["sirui-php@DESKTOP-PSVFMK8",[[-1,7,"认识"]],[9,9],[7,7]]],[1568016170612,["sirui-php@DESKTOP-PSVFMK8",[[1,7,"xue"]],[7,7],[10,10]]],[1568016171235,["sirui-php@DESKTOP-PSVFMK8",[[-1,7,"xue"]],[10,10],[7,7]]],[1568016171715,["sirui-php@DESKTOP-PSVFMK8",[[1,7,"xue"]],[7,7],[10,10]]],[1568016172339,["sirui-php@DESKTOP-PSVFMK8",[[-1,7,"xue"]],[10,10],[7,7]]],[1568016173341,["sirui-php@DESKTOP-PSVFMK8",[[1,7,"学习"]],[7,7],[9,9]]],[1568016192790,["sirui-php@DESKTOP-PSVFMK8",[[1,76,"因为PHP垃圾回收机制就是基于``"]],[76,76],[93,93]]],[1568016195445,["sirui-php@DESKTOP-PSVFMK8",[[1,92,"引用计数的"]],[92,92],[97,97]]],[1568016197058,["sirui-php@DESKTOP-PSVFMK8",[[-1,96,"的"]],[97,97],[96,96]]],[1568016198311,["sirui-php@DESKTOP-PSVFMK8",[[1,97,"的，"]],[97,97],[99,99]]],[1568016929988,["sirui-php@DESKTOP-PSVFMK8",[[-1,257,"。"]],[258,258],[257,257]]],[1568016937590,["sirui-php@DESKTOP-PSVFMK8",[[1,257,"，当然主要侧重与解释"]],[257,257],[267,267]]],[1568016938291,["sirui-php@DESKTOP-PSVFMK8",[[-1,264,"与解释"]],[267,267],[264,264]]],[1568016946279,["sirui-php@DESKTOP-PSVFMK8",[[1,264,"于解释信的"]],[264,264],[269,269]]],[1568016947252,["sirui-php@DESKTOP-PSVFMK8",[[-1,267,"信的"]],[269,269],[267,267]]],[1568016948975,["sirui-php@DESKTOP-PSVFMK8",[[1,267,"信"]],[267,267],[268,268]]],[1568016949275,["sirui-php@DESKTOP-PSVFMK8",[[-1,267,"信"]],[268,268],[267,267]]],[1568016950001,["sirui-php@DESKTOP-PSVFMK8",[[1,267,"新的"]],[267,267],[269,269]]],[1568016953004,["sirui-php@DESKTOP-PSVFMK8",[[-1,268,"的"]],[269,269],[268,268]]],[1568016953889,["sirui-php@DESKTOP-PSVFMK8",[[1,268,"av"]],[268,268],[270,270]]],[1568016954415,["sirui-php@DESKTOP-PSVFMK8",[[-1,268,"av"]],[270,270],[268,268]]],[1568016964361,["sirui-php@DESKTOP-PSVFMK8",[[1,268,"zval容器中的引用计数机制"]],[268,268],[282,282]]],[1568017006775,["sirui-php@DESKTOP-PSVFMK8",[[1,282,"。"]],[282,282],[283,283]]],[1568017015733,["sirui-php@DESKTOP-PSVFMK8",[[1,309," "]],[309,309],[310,310]]],[1568017023790,["sirui-php@DESKTOP-PSVFMK8",[[-1,569,"。"]],[570,570],[569,569]]],[1568017024186,["sirui-php@DESKTOP-PSVFMK8",[[1,569,"吗，"]],[569,569],[571,571]]],[1568017024844,["sirui-php@DESKTOP-PSVFMK8",[[-1,569,"吗，"]],[571,571],[569,569]]],[1568017035418,["sirui-php@DESKTOP-PSVFMK8",[[1,569,"，这是PHP官方手册"]],[569,569],[579,579]]],[1568017042389,["sirui-php@DESKTOP-PSVFMK8",[[1,580,"一个说法，估计也是PHP6"]],[580,580],[593,593]]],[1568017042812,["sirui-php@DESKTOP-PSVFMK8",[[-1,592,"6"]],[593,593],[592,592]]],[1568017045711,["sirui-php@DESKTOP-PSVFMK8",[[1,592,"5.x版本的一个"]],[592,592],[600,600]]],[1568017052326,["sirui-php@DESKTOP-PSVFMK8",[[-1,582,"说法"]],[584,584],[582,582]]],[1568017052845,["sirui-php@DESKTOP-PSVFMK8",[[1,582,"jiang"]],[582,582],[587,587]]],[1568017053853,["sirui-php@DESKTOP-PSVFMK8",[[-1,582,"jiang"]],[587,587],[582,582]]],[1568017055438,["sirui-php@DESKTOP-PSVFMK8",[[1,582,"讲解"]],[582,582],[584,584]]],[1568017057924,["sirui-php@DESKTOP-PSVFMK8",[[-1,597,"的一个"]],[600,600],[597,597]]],[1568017060954,["sirui-php@DESKTOP-PSVFMK8",[[1,589,"使用与"]],[589,589],[592,592]]],[1568017063470,["sirui-php@DESKTOP-PSVFMK8",[[1,600,"，我用"]],[600,600],[603,603]]],[1568017063828,["sirui-php@DESKTOP-PSVFMK8",[[-1,602,"用"]],[603,603],[602,602]]],[1568017071478,["sirui-php@DESKTOP-PSVFMK8",[[1,602,"们用代码来演示一下"]],[602,602],[611,611]]],[1568017071667,["sirui-php@DESKTOP-PSVFMK8",[[1,618,"\n"]],[611,611],[612,612]]],[1568017072939,["sirui-php@DESKTOP-PSVFMK8",[[1,619,"\n"]],[612,612],[613,613]]],[1568017073484,["sirui-php@DESKTOP-PSVFMK8",[[1,613,"```"]],[613,613],[616,616]]],[1568017073507,["sirui-php@DESKTOP-PSVFMK8",[[1,616,"language\n```\n"]],[616,616],[616,624]]],[1568017074350,["sirui-php@DESKTOP-PSVFMK8",[[-1,616,"language"]],[616,624],[616,616]]],[1568017074806,["sirui-php@DESKTOP-PSVFMK8",[[1,616,"php"]],[616,616],[619,619]]],[1568017075020,["sirui-php@DESKTOP-PSVFMK8",[[1,620,"\n"]],[619,619],[620,620]]],[1568017075149,["sirui-php@DESKTOP-PSVFMK8",[[1,621,"\n"]],[620,620],[621,621]]],[1568017122509,[null,[[-1,579,"\n"],[1,580,"的"],[1,625,"\n"]],[579,579],[626,626]]],[1568017122509,[null,[[1,579,"\n"],[-1,579,"的"],[-1,625,"\n"]],[626,626],[579,579]]],[1568017100699,["sirui-php@DESKTOP-PSVFMK8",[[1,620,"$a = ''"]],[620,620],[627,627]]],[1568017102793,["sirui-php@DESKTOP-PSVFMK8",[[1,626,"New"]],[626,626],[629,629]]],[1568017104531,["sirui-php@DESKTOP-PSVFMK8",[[-1,626,"New"]],[629,629],[626,626]]],[1568017106877,["sirui-php@DESKTOP-PSVFMK8",[[1,626,"new string"]],[626,626],[636,636]]],[1568017108812,["sirui-php@DESKTOP-PSVFMK8",[[1,637,"l"]],[637,637],[638,638]]],[1568017109027,["sirui-php@DESKTOP-PSVFMK8",[[1,640,"\n"]],[638,638],[639,639]]],[1568017109559,["sirui-php@DESKTOP-PSVFMK8",[[-1,640,"\n"]],[639,639],[638,638]]],[1568017109710,["sirui-php@DESKTOP-PSVFMK8",[[-1,637,"l"]],[638,638],[637,637]]],[1568017110044,["sirui-php@DESKTOP-PSVFMK8",[[1,637,";"]],[637,637],[638,638]]],[1568017110292,["sirui-php@DESKTOP-PSVFMK8",[[1,640,"\n"]],[638,638],[639,639]]],[1568017110445,["sirui-php@DESKTOP-PSVFMK8",[[1,641,"\n"]],[639,639],[640,640]]],[1568017119813,["sirui-php@DESKTOP-PSVFMK8",[[1,640,"xdebug_debug_zval()"]],[640,640],[659,659]]],[1568017120956,["sirui-php@DESKTOP-PSVFMK8",[[1,658,"''"]],[658,658],[660,660]]],[1568017121511,["sirui-php@DESKTOP-PSVFMK8",[[1,659,"a"]],[659,659],[660,660]]],[1568017122175,["sirui-php@DESKTOP-PSVFMK8",[[1,662,"l"]],[662,662],[663,663]]],[1568017123431,[null,[[-1,579,"\n"],[1,580,"的"],[1,668,"\n"]],[579,579],[669,669]]],[1568017123431,[null,[[1,579,"\n"],[-1,579,"的"],[-1,668,"\n"]],[669,669],[579,579]]],[1568017122987,["sirui-php@DESKTOP-PSVFMK8",[[-1,662,"l"]],[663,663],[662,662]]],[1568017123173,["sirui-php@DESKTOP-PSVFMK8",[[1,662,";"]],[662,662],[663,663]]],[1568017124906,[null,[[-1,579,"\n"],[1,580,"的"],[1,668,"\n"]],[579,579],[669,669]]],[1568017124906,[null,[[1,579,"\n"],[-1,579,"的"],[-1,668,"\n"]],[669,669],[579,579]]],[1568017124603,["sirui-php@DESKTOP-PSVFMK8",[[-1,664,"\n"]],[664,664],[663,663]]],[1568017244915,[null,[[-1,579,"\n"],[1,580,"的"],[1,667,"\n"]],[579,579],[668,668]]],[1568017244915,[null,[[1,579,"\n"],[-1,579,"的"],[-1,667,"\n"]],[668,668],[579,579]]],[1568017194323,["sirui-php@DESKTOP-PSVFMK8",[[1,664,"\n"]],[663,663],[664,664]]],[1568017194483,["sirui-php@DESKTOP-PSVFMK8",[[1,665,"\n"]],[664,664],[665,665]]],[1568017206181,["sirui-php@DESKTOP-PSVFMK8",[[1,665,"$a = 'new string';\n\nxdebug_debug_zval('a');"]],[665,665],[708,708]]],[1568017206929,["sirui-php@DESKTOP-PSVFMK8",[[-1,665,"$a = 'new string';\n\nxdebug_debug_zval('a');"]],[708,708],[665,665]]],[1568017211548,["sirui-php@DESKTOP-PSVFMK8",[[1,665,"a: (refcount=1, is_ref=0)='new string'"]],[665,665],[703,703]]],[1568017214043,["sirui-php@DESKTOP-PSVFMK8",[[1,665,"\n"]],[664,664],[665,665]]],[1568017214527,["sirui-php@DESKTOP-PSVFMK8",[[1,665,"##"]],[665,665],[667,667]]],[1568017215811,["sirui-php@DESKTOP-PSVFMK8",[[-1,665,"##"]],[667,667],[665,665]]],[1568017217484,["sirui-php@DESKTOP-PSVFMK8",[[1,665,"、、"]],[665,665],[667,667]]],[1568017218003,["sirui-php@DESKTOP-PSVFMK8",[[-1,665,"、、"]],[667,667],[665,665]]],[1568017222552,["sirui-php@DESKTOP-PSVFMK8",[[1,665,"//打印结果："]],[665,665],[672,672]]],[1568017224683,["sirui-php@DESKTOP-PSVFMK8",[[1,673,"\n"]],[672,672],[673,673]]],[1568017304915,[null,[[-1,579,"\n"],[1,580,"的"],[1,716,"\n"]],[579,579],[717,717]]],[1568017304915,[null,[[1,579,"\n"],[-1,579,"的"],[-1,716,"\n"]],[717,717],[579,579]]],[1568017246348,["sirui-php@DESKTOP-PSVFMK8",[[1,724,"\n"]],[717,717],[718,718]]],[1568017247292,["sirui-php@DESKTOP-PSVFMK8",[[1,718,"zhu="]],[718,718],[722,722]]],[1568017248058,["sirui-php@DESKTOP-PSVFMK8",[[-1,718,"zhu="]],[722,722],[718,718]]],[1568017249252,["sirui-php@DESKTOP-PSVFMK8",[[1,718,"注意，"]],[718,718],[721,721]]],[1568017249676,["sirui-php@DESKTOP-PSVFMK8",[[-1,720,"，"]],[721,721],[720,720]]],[1568017255751,["sirui-php@DESKTOP-PSVFMK8",[[1,720,"：你需要安装xdebug插件"]],[720,720],[734,734]]],[1568017256076,["sirui-php@DESKTOP-PSVFMK8",[[-1,732,"插件"]],[734,734],[732,732]]],[1568017258566,["sirui-php@DESKTOP-PSVFMK8",[[1,732,"拓展 才"]],[732,732],[736,736]]],[1568017258980,["sirui-php@DESKTOP-PSVFMK8",[[-1,734," 才"]],[736,736],[734,734]]],[1568017260783,["sirui-php@DESKTOP-PSVFMK8",[[1,734,"才亦可以"]],[734,734],[738,738]]],[1568017261759,["sirui-php@DESKTOP-PSVFMK8",[[-1,735,"亦可以"]],[738,738],[735,735]]],[1568017274800,["sirui-php@DESKTOP-PSVFMK8",[[1,735,"可以执行以上代码，使用debug+__"]],[735,735],[753,753]]],[1568017275399,["sirui-php@DESKTOP-PSVFMK8",[[-1,751,"+_"]],[753,753],[751,751]]],[1568017282367,["sirui-php@DESKTOP-PSVFMK8",[[1,751,"  "]],[751,751],[753,753]]],[1568017286268,["sirui-php@DESKTOP-PSVFMK8",[[-1,752," "]],[753,753],[752,752]]],[1568017290838,["sirui-php@DESKTOP-PSVFMK8",[[1,753,"zval-d"]],[753,753],[759,759]]],[1568017291619,["sirui-php@DESKTOP-PSVFMK8",[[-1,757,"-d"]],[759,759],[757,757]]],[1568017292712,["sirui-php@DESKTOP-PSVFMK8",[[1,757,"_dy"]],[757,757],[760,760]]],[1568017293655,["sirui-php@DESKTOP-PSVFMK8",[[-1,759,"y"]],[760,760],[759,759]]],[1568017294261,["sirui-php@DESKTOP-PSVFMK8",[[1,759,"ump"]],[759,759],[762,762]]],[1568017297182,["sirui-php@DESKTOP-PSVFMK8",[[-1,751," "]],[752,752],[751,751]]],[1568017364930,[null,[[-1,579,"\n"],[1,580,"的"],[1,761,"\n"]],[579,579],[762,762]]],[1568017364930,[null,[[1,579,"\n"],[-1,579,"的"],[-1,761,"\n"]],[762,762],[579,579]]],[1568017324173,["sirui-php@DESKTOP-PSVFMK8",[[1,761,"也可以打印出，但是debug_av"]],[761,761],[778,778]]],[1568017324796,["sirui-php@DESKTOP-PSVFMK8",[[-1,776,"av"]],[778,778],[776,776]]],[1568017341900,["sirui-php@DESKTOP-PSVFMK8",[[1,776,"zval_dump打印的结果与xdebug_debug_zval  "]],[776,776],[810,810]]],[1568017342494,["sirui-php@DESKTOP-PSVFMK8",[[-1,808,"  "]],[810,810],[808,808]]],[1568017342997,["sirui-php@DESKTOP-PSVFMK8",[[1,808,"day"]],[808,808],[811,811]]],[1568017343580,["sirui-php@DESKTOP-PSVFMK8",[[-1,808,"day"]],[811,811],[808,808]]],[1568017349334,["sirui-php@DESKTOP-PSVFMK8",[[1,808," 打印的结果存在差异，"]],[808,808],[819,819]]],[1568017424919,[null,[[-1,579,"\n"],[1,580,"的"],[1,819,"\n"]],[579,579],[820,820]]],[1568017424919,[null,[[1,579,"\n"],[-1,579,"的"],[-1,819,"\n"]],[820,820],[579,579]]],[1568017403071,["sirui-php@DESKTOP-PSVFMK8",[[1,819,"具体说明在本文不闲"]],[819,819],[828,828]]],[1568017403508,["sirui-php@DESKTOP-PSVFMK8",[[-1,826,"不闲"]],[828,828],[826,826]]],[1568017409434,["sirui-php@DESKTOP-PSVFMK8",[[1,826,"章中不作解释，可以"]],[826,826],[835,835]]],[1568017414703,["sirui-php@DESKTOP-PSVFMK8",[[-1,833,"可以"]],[835,835],[833,833]]],[1568017417199,["sirui-php@DESKTOP-PSVFMK8",[[1,833,"在文末文章"]],[833,833],[838,838]]],[1568017418118,["sirui-php@DESKTOP-PSVFMK8",[[-1,833,"在文末文章"]],[838,838],[833,833]]],[1568017424008,["sirui-php@DESKTOP-PSVFMK8",[[1,833,"具体可查看"]],[833,833],[838,838]]],[1568017484925,[null,[[-1,579,"\n"],[1,580,"的"],[1,838,"\n"]],[579,579],[839,839]]],[1568017484925,[null,[[1,579,"\n"],[-1,579,"的"],[-1,838,"\n"]],[839,839],[579,579]]],[1568017426449,["sirui-php@DESKTOP-PSVFMK8",[[1,838,"<>"]],[838,838],[840,840]]],[1568017447828,["sirui-php@DESKTOP-PSVFMK8",[[-1,838,"<>"]],[840,840],[838,838]]],[1568017448040,["sirui-php@DESKTOP-PSVFMK8",[[1,838,"[https://blog.csdn.net/pzqingchong/article/details/78004840](https://blog.csdn.net/pzqingchong/article/details/78004840)"]],[838,838],[958,958]]],[1568017455326,["sirui-php@DESKTOP-PSVFMK8",[[-1,839,"https://blog.csdn.net/pzqingchong/article/details/78004840"]],[839,897],[839,839]]],[1568017544921,[null,[[-1,579,"\n"],[1,580,"的"],[1,900,"\n"]],[579,579],[901,901]]],[1568017544921,[null,[[1,579,"\n"],[-1,579,"的"],[-1,900,"\n"]],[901,901],[579,579]]],[1568017494061,["sirui-php@DESKTOP-PSVFMK8",[[1,839,"# PHP xdebug_debug_zval debug_zval_dump 使用"]],[839,839],[881,881]]],[1568017495220,["sirui-php@DESKTOP-PSVFMK8",[[-1,839,"# PHP xdebug_debug_zval debug_zval_dump 使用"]],[881,881],[839,839]]],[1568017500924,["sirui-php@DESKTOP-PSVFMK8",[[1,839,"# PHP xdebug_debug_zval debug_zval_dump 使用"]],[839,839],[881,881]]],[1568017502744,["sirui-php@DESKTOP-PSVFMK8",[[-1,839,"# "]],[841,841],[839,839]]],[1568017509168,["sirui-php@DESKTOP-PSVFMK8",[[1,838,":"]],[838,838],[839,839]]],[1568017509824,["sirui-php@DESKTOP-PSVFMK8",[[-1,838,":"]],[839,839],[838,838]]],[1568017510418,["sirui-php@DESKTOP-PSVFMK8",[[1,838,"："]],[838,838],[839,839]]],[1568017516639,["sirui-php@DESKTOP-PSVFMK8",[[1,948,"\n"]],[943,943],[944,944]]],[1568017604922,[null,[[-1,579,"\n"],[1,580,"的"],[1,941,"\n"]],[579,579],[942,942]]],[1568017604922,[null,[[1,579,"\n"],[-1,579,"的"],[-1,941,"\n"]],[942,942],[579,579]]],[1568017581679,["sirui-php@DESKTOP-PSVFMK8",[[1,943,"从结果上面看 "]],[943,943],[950,950]]],[1568017583806,["sirui-php@DESKTOP-PSVFMK8",[[-1,946,"上面看 "]],[950,950],[946,946]]],[1568017588862,["sirui-php@DESKTOP-PSVFMK8",[[1,946,"得知，refcount  "]],[946,946],[959,959]]],[1568017589180,["sirui-php@DESKTOP-PSVFMK8",[[-1,958," "]],[959,959],[958,958]]],[1568017591791,["sirui-php@DESKTOP-PSVFMK8",[[1,958,"= 1代表 "]],[958,958],[964,964]]],[1568017592196,["sirui-php@DESKTOP-PSVFMK8",[[-1,963," "]],[964,964],[963,963]]],[1568017664925,[null,[[-1,579,"\n"],[1,580,"的"],[1,963,"\n"]],[579,579],[964,964]]],[1568017664925,[null,[[1,579,"\n"],[-1,579,"的"],[-1,963,"\n"]],[964,964],[579,579]]],[1568017626431,["sirui-php@DESKTOP-PSVFMK8",[[1,963,"有一个变量名纸箱"]],[963,963],[971,971]]],[1568017627544,["sirui-php@DESKTOP-PSVFMK8",[[-1,969,"纸箱"]],[971,971],[969,969]]],[1568017640245,["sirui-php@DESKTOP-PSVFMK8",[[1,969,"指向这个zval容器 is_ref =-"]],[969,969],[989,989]]],[1568017640856,["sirui-php@DESKTOP-PSVFMK8",[[-1,988,"-"]],[989,989],[988,988]]],[1568017642519,["sirui-php@DESKTOP-PSVFMK8",[[1,988," 0 带包"]],[988,988],[993,993]]],[1568017643444,["sirui-php@DESKTOP-PSVFMK8",[[-1,991,"带包"]],[993,993],[991,991]]],[1568017653464,["sirui-php@DESKTOP-PSVFMK8",[[1,991,"代表没有存在引用"]],[991,991],[999,999]]],[1568017655501,["sirui-php@DESKTOP-PSVFMK8",[[-1,997,"引用"]],[999,999],[997,997]]],[1568017660930,["sirui-php@DESKTOP-PSVFMK8",[[1,997,"应用吃"]],[997,997],[1000,1000]]],[1568017661972,["sirui-php@DESKTOP-PSVFMK8",[[-1,997,"应用吃"]],[1000,1000],[997,997]]],[1568017664567,["sirui-php@DESKTOP-PSVFMK8",[[1,997,"引用传递"]],[997,997],[1001,1001]]],[1568017724927,[null,[[-1,579,"\n"],[1,580,"的"],[1,1001,"\n"]],[579,579],[1002,1002]]],[1568017724927,[null,[[1,579,"\n"],[-1,579,"的"],[-1,1001,"\n"]],[1002,1002],[579,579]]],[1568017675829,["sirui-php@DESKTOP-PSVFMK8",[[1,1007,"\n"]],[1001,1001],[1002,1002]]],[1568017676045,["sirui-php@DESKTOP-PSVFMK8",[[1,1008,"\n"]],[1002,1002],[1003,1003]]],[1568017676812,["sirui-php@DESKTOP-PSVFMK8",[[-1,1008,"\n"]],[1003,1003],[1002,1002]]],[1568017676973,["sirui-php@DESKTOP-PSVFMK8",[[-1,1007,"\n"]],[1002,1002],[1001,1001]]],[1568017684910,["sirui-php@DESKTOP-PSVFMK8",[[1,1001,"，下面我们增加代码，并且使用php"]],[1001,1001],[1018,1018]]],[1568017695197,["sirui-php@DESKTOP-PSVFMK8",[[-1,1013,"使用php"]],[1018,1018],[1013,1013]]],[1568017695743,["sirui-php@DESKTOP-PSVFMK8",[[1,1013,"fen"]],[1013,1013],[1016,1016]]],[1568017696307,["sirui-php@DESKTOP-PSVFMK8",[[-1,1013,"fen"]],[1016,1016],[1013,1013]]],[1568017696775,["sirui-php@DESKTOP-PSVFMK8",[[1,1013,"fen"]],[1013,1013],[1016,1016]]],[1568017697532,["sirui-php@DESKTOP-PSVFMK8",[[-1,1013,"fen"]],[1016,1016],[1013,1013]]],[1568017704885,["sirui-php@DESKTOP-PSVFMK8",[[1,1013,"分别使用PHP5.5"]],[1013,1013],[1023,1023]]],[1568017705727,["sirui-php@DESKTOP-PSVFMK8",[[-1,1022,"5"]],[1023,1023],[1022,1022]]],[1568017713663,["sirui-php@DESKTOP-PSVFMK8",[[1,1022,"6的环境与PHP7.3的环境执行"]],[1022,1022],[1038,1038]]],[1568017713856,["sirui-php@DESKTOP-PSVFMK8",[[1,1044,"\n"]],[1038,1038],[1039,1039]]],[1568017714248,["sirui-php@DESKTOP-PSVFMK8",[[1,1045,"\n"]],[1039,1039],[1040,1040]]],[1568017717077,["sirui-php@DESKTOP-PSVFMK8",[[1,1040,"PHP5.6:"]],[1040,1040],[1047,1047]]],[1568017717300,["sirui-php@DESKTOP-PSVFMK8",[[1,1053,"\n"]],[1047,1047],[1048,1048]]],[1568017718733,["sirui-php@DESKTOP-PSVFMK8",[[1,1048,"```"]],[1048,1048],[1051,1051]]],[1568017718759,["sirui-php@DESKTOP-PSVFMK8",[[1,1051,"language\n```\n"]],[1051,1051],[1051,1059]]],[1568017719542,["sirui-php@DESKTOP-PSVFMK8",[[-1,1051,"language"]],[1051,1059],[1051,1051]]],[1568017720000,["sirui-php@DESKTOP-PSVFMK8",[[1,1051,"pohp"]],[1051,1051],[1055,1055]]],[1568017720244,["sirui-php@DESKTOP-PSVFMK8",[[1,1056,"\n"]],[1055,1055],[1056,1056]]],[1568017720799,["sirui-php@DESKTOP-PSVFMK8",[[-1,1056,"\n"]],[1056,1056],[1055,1055]]],[1568017721268,["sirui-php@DESKTOP-PSVFMK8",[[-1,1052,"ohp"]],[1055,1055],[1052,1052]]],[1568017721510,["sirui-php@DESKTOP-PSVFMK8",[[1,1052,"p"]],[1052,1052],[1053,1053]]],[1568017722060,["sirui-php@DESKTOP-PSVFMK8",[[-1,1052,"p"]],[1053,1053],[1052,1052]]],[1568017722301,["sirui-php@DESKTOP-PSVFMK8",[[1,1052,"hp"]],[1052,1052],[1054,1054]]],[1568017723204,["sirui-php@DESKTOP-PSVFMK8",[[1,1055,"\n"]],[1054,1054],[1055,1055]]],[1568018752799,[null,[[-1,579,"\n"],[1,580,"的"]],[579,579],[581,581]]],[1568018752799,[null,[[1,579,"\n"],[-1,579,"的"]],[581,581],[579,579]]],[1568018749097,["sirui-php@DESKTOP-PSVFMK8",[[1,1038,"行"]],[1037,1038],[1038,1038]]],[1568018750752,["sirui-php@DESKTOP-PSVFMK8",[[-1,1038,"行"]],[1038,1038],[1037,1038]]],[1568018872796,[null,[[-1,579,"\n"],[1,580,"的"]],[579,579],[581,581]]],[1568018872796,[null,[[1,579,"\n"],[-1,579,"的"]],[581,581],[579,579]]],[1568018847461,["sirui-php@DESKTOP-PSVFMK8",[[-1,1040,"PHP5.6:"]],[1040,1047],[1040,1040]]],[1568018847764,["sirui-php@DESKTOP-PSVFMK8",[[-1,1040,"\n"]],[1040,1040],[1039,1039]]],[1568018858893,["sirui-php@DESKTOP-PSVFMK8",[[1,1047,"$a = 'new string';\n\n$b = $a;\n\nxdebug_debug_zval('a');\n"]],[1047,1047],[1101,1101]]],[1568018860341,["sirui-php@DESKTOP-PSVFMK8",[[-1,1101,"\n"]],[1101,1101],[1100,1100]]],[1568018862720,["sirui-php@DESKTOP-PSVFMK8",[[1,1101,"\n"]],[1100,1100],[1101,1101]]],[1568018862916,["sirui-php@DESKTOP-PSVFMK8",[[1,1102,"\n"]],[1101,1101],[1102,1102]]],[1568018868830,["sirui-php@DESKTOP-PSVFMK8",[[1,1102,"//PHP5.6执行结果："]],[1102,1102],[1115,1115]]],[1568018869542,["sirui-php@DESKTOP-PSVFMK8",[[1,1116,"\n"]],[1115,1115],[1116,1116]]],[1568019052799,[null,[[-1,579,"\n"],[1,580,"的"]],[579,579],[581,581]]],[1568019052799,[null,[[1,579,"\n"],[-1,579,"的"]],[581,581],[579,579]]],[1568019016093,["sirui-php@DESKTOP-PSVFMK8",[[1,1116,"a: (refcount=2, is_ref=0)='new string'"]],[1116,1116],[1154,1154]]],[1568019017652,["sirui-php@DESKTOP-PSVFMK8",[[1,1155,"\n"]],[1154,1154],[1155,1155]]],[1568019017821,["sirui-php@DESKTOP-PSVFMK8",[[1,1156,"\n"]],[1155,1155],[1156,1156]]],[1568019018232,["sirui-php@DESKTOP-PSVFMK8",[[1,1156,"、、"]],[1156,1156],[1158,1158]]],[1568019018860,["sirui-php@DESKTOP-PSVFMK8",[[-1,1156,"、、"]],[1158,1158],[1156,1156]]],[1568019024998,["sirui-php@DESKTOP-PSVFMK8",[[1,1156,"//PHP7.3执行结果："]],[1156,1156],[1169,1169]]],[1568019025446,["sirui-php@DESKTOP-PSVFMK8",[[1,1170,"\n"]],[1169,1169],[1170,1170]]],[1568019026591,["sirui-php@DESKTOP-PSVFMK8",[[1,1170,"a: (refcount=2, is_ref=0)='new string'"]],[1170,1170],[1208,1208]]],[1568019028353,["sirui-php@DESKTOP-PSVFMK8",[[-1,1183,"2"],[1,1184,"1"]],[1183,1184],[1184,1184]]],[1568019037373,["sirui-php@DESKTOP-PSVFMK8",[[1,1214,"从结果发现，PHP5.6de "]],[1214,1214],[1229,1229]]],[1568019037997,["sirui-php@DESKTOP-PSVFMK8",[[-1,1226,"de "]],[1229,1229],[1226,1226]]],[1568019051963,["sirui-php@DESKTOP-PSVFMK8",[[1,1226,"的refcount发生了变化，数值增加了1，而"]],[1226,1226],[1249,1249]]],[1568019112806,[null,[[-1,579,"\n"],[1,580,"的"]],[579,579],[581,581]]],[1568019112806,[null,[[1,579,"\n"],[-1,579,"的"]],[581,581],[579,579]]],[1568019059599,["sirui-php@DESKTOP-PSVFMK8",[[1,1249,"PHPPHP"]],[1249,1249],[1255,1255]]],[1568019060580,["sirui-php@DESKTOP-PSVFMK8",[[-1,1252,"PHP"]],[1255,1255],[1252,1252]]],[1568019064823,["sirui-php@DESKTOP-PSVFMK8",[[1,1252,"7.3的结果"]],[1252,1252],[1258,1258]]],[1568019065316,["sirui-php@DESKTOP-PSVFMK8",[[-1,1256,"结果"]],[1258,1258],[1256,1256]]],[1568019109388,["sirui-php@DESKTOP-PSVFMK8",[[1,1256,"结果却没发生过变化，当我们增加变量引用时同样也不会变"]],[1256,1256],[1282,1282]]],[1568019109605,["sirui-php@DESKTOP-PSVFMK8",[[-1,1281,"变"]],[1282,1282],[1281,1281]]],[1568019111639,["sirui-php@DESKTOP-PSVFMK8",[[1,1281,"发生变化"]],[1281,1281],[1285,1285]]],[1568019232822,[null,[[-1,579,"\n"],[1,580,"的"]],[579,579],[581,581]]],[1568019232822,[null,[[1,579,"\n"],[-1,579,"的"]],[581,581],[579,579]]],[1568019229731,["sirui-php@DESKTOP-PSVFMK8",[[1,1285,"，在查阅"]],[1285,1285],[1289,1289]]],[1568019292812,[null,[[-1,579,"\n"],[1,580,"的"]],[579,579],[581,581]]],[1568019292812,[null,[[1,579,"\n"],[-1,579,"的"]],[581,581],[579,579]]],[1568019233245,["sirui-php@DESKTOP-PSVFMK8",[[-1,1291,"治疗"]],[1293,1293],[1291,1291]]],[1568019237280,["sirui-php@DESKTOP-PSVFMK8",[[1,1291,"资料后发现，原来是"]],[1291,1291],[1300,1300]]],[1568019352806,[null,[[-1,579,"\n"],[1,580,"的"],[-1,1289,"\n\n"],[1,1291,"有关"],[1,1301,"\n\n\n\n"]],[579,579],[1305,1305]]],[1568019352806,[null,[[1,579,"\n"],[-1,579,"的"],[1,1289,"\n\n"],[-1,1289,"有关"],[-1,1301,"\n\n\n\n"]],[1305,1305],[579,579]]],[1568019349886,["sirui-php@DESKTOP-PSVFMK8",[[1,297,"5.6"]],[297,297],[300,300]]],[1568019350753,["sirui-php@DESKTOP-PSVFMK8",[[-1,297,"5.6"]],[300,300],[297,297]]],[1568019412814,[null,[[-1,579,"\n"],[1,580,"的"],[-1,1289,"\n\n"],[1,1291,"有关"],[1,1301,"\n\n\n\n"]],[579,579],[1305,1305]]],[1568019412814,[null,[[1,579,"\n"],[-1,579,"的"],[1,1289,"\n\n"],[-1,1289,"有关"],[-1,1301,"\n\n\n\n"]],[1305,1305],[579,579]]],[1568019357556,["sirui-php@DESKTOP-PSVFMK8",[[1,1300,"5.6与"]],[1300,1300],[1304,1304]]],[1568019358973,["sirui-php@DESKTOP-PSVFMK8",[[-1,1300,"5.6与"]],[1304,1304],[1300,1300]]],[1568019359664,["sirui-php@DESKTOP-PSVFMK8",[[1,1300,"A"]],[1300,1300],[1301,1301]]],[1568019360215,["sirui-php@DESKTOP-PSVFMK8",[[-1,1300,"A"]],[1301,1301],[1300,1300]]],[1568019365151,["sirui-php@DESKTOP-PSVFMK8",[[1,1300,"zval容器发生了更"]],[1300,1300],[1310,1310]]],[1568019365342,["sirui-php@DESKTOP-PSVFMK8",[[-1,1309,"更"]],[1310,1310],[1309,1309]]],[1568019366209,["sirui-php@DESKTOP-PSVFMK8",[[1,1309,"变化"]],[1309,1309],[1311,1311]]],[1568019367335,["sirui-php@DESKTOP-PSVFMK8",[[-1,1306,"发生了变化"]],[1311,1311],[1306,1306]]],[1568019389902,["sirui-php@DESKTOP-PSVFMK8",[[1,1306,"结构更新了，不同于PHP5.6,"]],[1306,1306],[1322,1322]]],[1568019712822,[null,[[-1,579,"\n"],[1,580,"的"],[-1,1289,"\n\n"],[1,1291,"有关"],[1,1323,"\n\n\n\n"]],[579,579],[1327,1327]]],[1568019712822,[null,[[1,579,"\n"],[-1,579,"的"],[1,1289,"\n\n"],[-1,1289,"有关"],[-1,1323,"\n\n\n\n"]],[1327,1327],[579,579]]],[1568019678385,["sirui-php@DESKTOP-PSVFMK8",[[1,1322," PHP7.3的A"]],[1322,1322],[1331,1331]]],[1568019679076,["sirui-php@DESKTOP-PSVFMK8",[[-1,1330,"A"]],[1331,1331],[1330,1330]]],[1568019679399,["sirui-php@DESKTOP-PSVFMK8",[[1,1330,"v"]],[1330,1330],[1331,1331]]],[1568019680303,["sirui-php@DESKTOP-PSVFMK8",[[-1,1330,"v"]],[1331,1331],[1330,1330]]],[1568019681389,["sirui-php@DESKTOP-PSVFMK8",[[1,1330,"zval"]],[1330,1330],[1334,1334]]]],null,"sirui-php@DESKTOP-PSVFMK8"],["2d790cf3-07b5-4ff1-a7ba-43c2bbeb292c",1568076966867,"## 前言\n在学习PHP垃圾回收机制之前先让我们来学习下 `引用计数` 的基本知识，学习 `引用计数` 有助于我们了解垃圾回收机制的原理以及php底层，因为PHP垃圾回收机制就是基于`引用计数`的，在介绍引用计数之前，我曾翻阅过PHP的官方手册，在测试代码的时候发现运行结果与官方手册所写的不符，翻阅相关资料之后发现是官方手册还停留在PH5.x的版本上，而我本地的环境是PHP7.3,所以导致代码结果与官方手册不符，关于为什么不符合，在下文会详细说明，并且会说明引用计数在PHP5.x版本与PHP7.x版本的差异性，当然主要侧重于解释新zval容器中的引用计数机制。\n\n\n## 引用计数基本知识\n\n首先我们先来了解一下 `引用计数`，引用官方文档的一段话 每个php变量存在一个叫\"zval\"的变量容器中。容器除了包含变量的类型和值，还包括两个字节的额外信息。第一个是\"is_ref\"，是个bool值，用来标识这个变量是否是属于引用集合(reference set)。通过这个字节，php引擎才能把普通变量和引用变量区分开来，由于php允许用户通过使用&来使用自定义引用，zval变量容器中还有一个内部引用计数机制，来优化内存使用。第二个额外字节是\"refcount\"，用以表示指向这个zval变量容器的变量(也称符号即symbol)个数，这是PHP官方手册的一个讲解，估计也是使用与PHP5.x版本，我们用代码来演示一下\n\n```php\n$a = 'new string';\n\nxdebug_debug_zval('a');\n\n//打印结果：\n\na: (refcount=1, is_ref=0)='new string'\n```\n\n注意：你需要安装xdebug拓展才可以执行以上代码，使用debug_zval_dump也可以打印出，但是debug_zval_dump打印的结果与xdebug_debug_zval 打印的结果存在差异，具体说明在本文章中不作解释，具体可查看：[PHP xdebug_debug_zval debug_zval_dump 使用](https://blog.csdn.net/pzqingchong/article/details/78004840)\n\n从结果得知，refcount = 1代表有一个变量名指向这个zval容器 is_ref = 0 代表没有存在引用传递，下面我们增加代码，并且分别使用PHP5.6的环境与PHP7.3的环境执行\n\n```php\n$a = 'new string';\n\n$b = $a;\n\nxdebug_debug_zval('a');\n\n//PHP5.6执行结果：\na: (refcount=2, is_ref=0)='new string'\n\n//PHP7.3执行结果：\na: (refcount=1, is_ref=0)='new string'\n```\n\n从结果发现，PHP5.6的refcount发生了变化，数值增加了1，而PHP7.3的结果却没发生过变化，当我们增加变量引用时同样也不会发生变化，在查阅有关资料后发现，原来是zval容器结构更新了，不同于PHP5.6, PHP7.3的zval\n\n\n\n\n",[[1568076916211,["sirui-php@DESKTOP-PSVFMK8",[[1,327,"："]],[327,327],[328,328]]],[1568076943920,["sirui-php@DESKTOP-PSVFMK8",[[-1,586,"估计也是使用与"]],[586,593],[586,586]]],[1568076953341,["sirui-php@DESKTOP-PSVFMK8",[[1,586,"而这个手册只适用于"]],[586,586],[595,595]]],[1568077623785,["sirui-php@DESKTOP-PSVFMK8",[[1,1337,"结构发生了"]],[1337,1337],[1342,1342]]],[1568077629912,["sirui-php@DESKTOP-PSVFMK8",[[-1,1339,"发生了"]],[1342,1342],[1339,1339]]],[1568077644136,["sirui-php@DESKTOP-PSVFMK8",[[1,1339,"也一样"]],[1339,1339],[1342,1342]]],[1568077650952,["sirui-php@DESKTOP-PSVFMK8",[[-1,1332,"的zval结构也一样"]],[1342,1342],[1332,1332]]],[1568077675049,["sirui-php@DESKTOP-PSVFMK8",[[1,1332,"版本的Zval版本发生了彻底更新"]],[1332,1332],[1348,1348]]],[1568077683399,["sirui-php@DESKTOP-PSVFMK8",[[-1,1339,"版本"]],[1341,1341],[1339,1339]]],[1568077685584,["sirui-php@DESKTOP-PSVFMK8",[[1,1339,"容器"]],[1339,1339],[1341,1341]]],[1568077686986,["sirui-php@DESKTOP-PSVFMK8",[[1,1341,"接口也"]],[1341,1341],[1344,1344]]],[1568077693488,["sirui-php@DESKTOP-PSVFMK8",[[-1,1315,"不同于PHP5.6, PHP7.3版本的Zval容器接口也发生了彻底更新"]],[1351,1351],[1315,1315]]],[1568077745201,["sirui-php@DESKTOP-PSVFMK8",[[1,1317,"PHP5.6版本的Zval容器："]],[1317,1317],[1333,1333]]],[1568077745360,["sirui-php@DESKTOP-PSVFMK8",[[1,1336,"\n"]],[1333,1333],[1334,1334]]],[1568077754328,["sirui-php@DESKTOP-PSVFMK8",[[-1,1322,"6"]],[1322,1322],[1322,1322]]],[1568077755033,["sirui-php@DESKTOP-PSVFMK8",[[1,1322,"x"]],[1322,1322],[1323,1323]]],[1568077757090,["sirui-php@DESKTOP-PSVFMK8",[[1,1335,"```"]],[1335,1335],[1338,1338]]],[1568077757115,["sirui-php@DESKTOP-PSVFMK8",[[1,1338,"language\n```\n"]],[1338,1338],[1338,1346]]],[1568077757915,["sirui-php@DESKTOP-PSVFMK8",[[-1,1338,"language"]],[1338,1346],[1338,1338]]],[1568077758138,["sirui-php@DESKTOP-PSVFMK8",[[1,1339,"\n"]],[1338,1338],[1339,1339]]],[1568077758423,["sirui-php@DESKTOP-PSVFMK8",[[1,1339,"struct _zval_struct {\n\tunion {\n\t\tlong lval;\n\t\tdouble dval;\n\t\tstruct {\n\t\t\tchar *val;\n\t\t\tint len;\n\t\t} str;\n\t\tHashTable *ht;\n\t\tzend_object_value obj;\n\t\tzend_ast *ast;\n\t} value;\n\tzend_uint refcount__gc;\n\tzend_uchar type;\n\tzend_uchar is_ref__gc;\n};"]],[1339,1339],[1582,1582]]],[1568077761561,["sirui-php@DESKTOP-PSVFMK8",[[1,1338,"c"]],[1338,1338],[1339,1339]]],[1568077783977,["sirui-php@DESKTOP-PSVFMK8",[[1,1590,"\n"]],[1588,1588],[1589,1589]]],[1568077786376,["sirui-php@DESKTOP-PSVFMK8",[[1,1589,"PHP7.0"]],[1589,1589],[1595,1595]]],[1568077788167,["sirui-php@DESKTOP-PSVFMK8",[[-1,1593,".0"]],[1595,1595],[1593,1593]]],[1568077791369,["sirui-php@DESKTOP-PSVFMK8",[[1,1593,".xbn"]],[1593,1593],[1597,1597]]],[1568077791872,["sirui-php@DESKTOP-PSVFMK8",[[-1,1595,"bn"]],[1597,1597],[1595,1595]]],[1568077796745,["sirui-php@DESKTOP-PSVFMK8",[[1,1595,"版本的z"]],[1595,1595],[1599,1599]]],[1568077797264,["sirui-php@DESKTOP-PSVFMK8",[[-1,1598,"z"]],[1599,1599],[1598,1598]]],[1568077800441,["sirui-php@DESKTOP-PSVFMK8",[[1,1598,"Zval容器："]],[1598,1598],[1605,1605]]],[1568077800635,["sirui-php@DESKTOP-PSVFMK8",[[1,1607,"\n"]],[1605,1605],[1606,1606]]],[1568077805744,["sirui-php@DESKTOP-PSVFMK8",[[1,1606,"`"]],[1606,1606],[1607,1607]]],[1568077806064,["sirui-php@DESKTOP-PSVFMK8",[[1,1607,"``"]],[1607,1607],[1609,1609]]],[1568077806089,["sirui-php@DESKTOP-PSVFMK8",[[1,1609,"language\n```\n"]],[1609,1609],[1609,1617]]],[1568077806831,["sirui-php@DESKTOP-PSVFMK8",[[-1,1609,"language"]],[1609,1617],[1609,1609]]],[1568077806979,["sirui-php@DESKTOP-PSVFMK8",[[1,1609,"c"]],[1609,1609],[1610,1610]]],[1568077807143,["sirui-php@DESKTOP-PSVFMK8",[[1,1611,"\n"]],[1610,1610],[1611,1611]]],[1568077807416,["sirui-php@DESKTOP-PSVFMK8",[[1,1611,"struct _zval_struct {\n\tunion {\n\t\tzend_long         lval;             /* long value */\n\t\tdouble            dval;             /* double value */\n\t\tzend_refcounted  *counted;\n\t\tzend_string      *str;\n\t\tzend_array       *arr;\n\t\tzend_object      *obj;\n\t\tzend_resource    *res;\n\t\tzend_reference   *ref;\n\t\tzend_ast_ref     *ast;\n\t\tzval             *zv;\n\t\tvoid             *ptr;\n\t\tzend_class_entry *ce;\n\t\tzend_function    *func;\n\t\tstruct {\n\t\t\tuint32_t w1;\n\t\t\tuint32_t w2;\n\t\t} ww;\n\t} value;\n    union {\n        struct {\n            ZEND_ENDIAN_LOHI_4(\n                zend_uchar    type,         /* active type */\n                zend_uchar    type_flags,\n                zend_uchar    const_flags,\n                zend_uchar    reserved)     /* call info for EX(This) */\n        } v;\n        uint32_t type_info;\n    } u1;\n    union {\n        uint32_t     var_flags;\n        uint32_t     next;                 /* hash collision chain */\n        uint32_t     cache_slot;           /* literal cache slot */\n        uint32_t     lineno;               /* line number (for ast nodes) */\n        uint32_t     num_args;             /* arguments number for EX(This) */\n        uint32_t     fe_pos;               /* foreach position */\n        uint32_t     fe_iter_idx;          /* foreach iterator index */\n    } u2;\n};"]],[1611,1611],[2913,2913]]],[1568077812462,["sirui-php@DESKTOP-PSVFMK8",[[-1,2919,"\n"],[1,2920,"一个"]],[2919,2919],[2921,2921]]],[1568077830977,["sirui-php@DESKTOP-PSVFMK8",[[1,2921,"全新的容器结构，对于该结构的详细描述可以参考文末鸟哥的文章，写的非常详细，我就不关公面前耍大刀了，这里我只提出几个比较关键的点："]],[2921,2921],[2985,2985]]],[1568077837525,["sirui-php@DESKTOP-PSVFMK8",[[-1,2943,"文末"]],[2943,2945],[2943,2943]]],[1568077846143,["sirui-php@DESKTOP-PSVFMK8",[[-1,2949,"写的非常详细，我就不关公面前耍大刀了，这里我只提出几个比较关键的点："]],[2949,2949],[2949,2949]]],[1568077854785,["sirui-php@DESKTOP-PSVFMK8",[[1,2949,"链接在``"]],[2949,2949],[2954,2954]]],[1568077858114,["sirui-php@DESKTOP-PSVFMK8",[[1,2953,"参考"]],[2953,2953],[2955,2955]]],[1568077858526,["sirui-php@DESKTOP-PSVFMK8",[[-1,2953,"参考"]],[2955,2955],[2953,2953]]],[1568077861868,["sirui-php@DESKTOP-PSVFMK8",[[1,2953,"引用文献"]],[2953,2953],[2957,2957]]],[1568077862224,["sirui-php@DESKTOP-PSVFMK8",[[-1,2955,"文献"]],[2957,2957],[2955,2955]]],[1568077863417,["sirui-php@DESKTOP-PSVFMK8",[[1,2955,"文章"]],[2955,2955],[2957,2957]]],[1568077865306,["sirui-php@DESKTOP-PSVFMK8",[[1,2958," 会"]],[2958,2958],[2960,2960]]],[1568077901170,["sirui-php@DESKTOP-PSVFMK8",[[1,2960,"放出来，对比PHP5.x，一下"]],[2960,2960],[2975,2975]]],[1568077902153,["sirui-php@DESKTOP-PSVFMK8",[[-1,2973,"一下"]],[2975,2975],[2973,2973]]],[1568077903378,["sirui-php@DESKTOP-PSVFMK8",[[1,2973,"以下"]],[2973,2973],[2975,2975]]],[1568077939703,["sirui-php@DESKTOP-PSVFMK8",[[-1,2973,"以下"]],[2975,2975],[2973,2973]]],[1568077951465,["sirui-php@DESKTOP-PSVFMK8",[[1,2973,"有几个重要的更新点："]],[2973,2973],[2983,2983]]],[1568077951655,["sirui-php@DESKTOP-PSVFMK8",[[1,2983,"\n\n"]],[2983,2983],[2984,2984]]],[1568077952888,["sirui-php@DESKTOP-PSVFMK8",[[-1,2984,"\n"],[1,2985,"1"]],[2984,2984],[2985,2985]]],[1568077976588,["sirui-php@DESKTOP-PSVFMK8",[[1,2985,". PHP7.x 变量分为变量名与变量值两部分，分别对饮"]],[2985,2985],[3013,3013]]],[1568077977273,["sirui-php@DESKTOP-PSVFMK8",[[-1,3011,"对饮"]],[3013,3013],[3011,3011]]],[1568077985624,["sirui-php@DESKTOP-PSVFMK8",[[1,3011,"对应zval_struct"]],[3011,3011],[3024,3024]]],[1568077987417,["sirui-php@DESKTOP-PSVFMK8",[[1,3024,"喝"]],[3024,3024],[3025,3025]]],[1568077988198,["sirui-php@DESKTOP-PSVFMK8",[[-1,3024,"喝"]],[3025,3025],[3024,3024]]],[1568077991022,["sirui-php@DESKTOP-PSVFMK8",[[1,3024,"和在其"]],[3024,3024],[3027,3027]]],[1568078001777,["sirui-php@DESKTOP-PSVFMK8",[[-1,2984,"1."],[1,2986,"*  "],[-1,2991,".x"],[1,2994,"中的"],[1,2998,"**"],[-1,3001,"与"],[1,3002,"**和**"],[1,3005,"**"],[1,3013," `"],[1,3024,"` "],[1,3027,"中声明的 `value`*   `zval_struct.value` 中的 `zend_long` 、`double` 都是**简单数据类型**，能够直接储存具体的值，而其他复杂数据类型储存一个指向其他数据结构的**指针**\n\n作者：Gtaker\n链接：https://juejin.im/post/5bbf50e86fb9a05ce02a9c19\n来源：掘金\n著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"]],[2984,3027],[3256,3256]]],[1568078006624,["sirui-php@DESKTOP-PSVFMK8",[[-1,3155,"作者：Gtaker"],[-1,3165,"链接：https://juejin.im/post/5bbf50e86fb9a05ce02a9c19\n来源：掘金\n著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"]],[3155,3256],[3155,3155]]],[1568078006817,["sirui-php@DESKTOP-PSVFMK8",[[-1,3155,"\n"]],[3155,3155],[3154,3154]]],[1568078008522,["sirui-php@DESKTOP-PSVFMK8",[[-1,2984,"*"]],[2985,2985],[2984,2984]]],[1568078008850,["sirui-php@DESKTOP-PSVFMK8",[[1,2984,"1."]],[2984,2984],[2986,2986]]],[1568078010340,["sirui-php@DESKTOP-PSVFMK8",[[-1,2985,".  "]],[2988,2988],[2985,2985]]],[1568078011572,["sirui-php@DESKTOP-PSVFMK8",[[1,2985,"。"]],[2985,2985],[2986,2986]]],[1568078011993,["sirui-php@DESKTOP-PSVFMK8",[[1,2987," "]],[2986,2986],[2987,2987]]],[1568078012984,["sirui-php@DESKTOP-PSVFMK8",[[-1,2985,"。 "]],[2987,2987],[2985,2985]]],[1568078013562,["sirui-php@DESKTOP-PSVFMK8",[[1,2985,"/"]],[2985,2985],[2986,2986]]],[1568078014408,["sirui-php@DESKTOP-PSVFMK8",[[-1,2985,"/"]],[2986,2986],[2985,2985]]],[1568078015529,["sirui-php@DESKTOP-PSVFMK8",[[1,2985,"."]],[2985,2985],[2986,2986]]],[1568078015874,["sirui-php@DESKTOP-PSVFMK8",[[1,2987," "]],[2986,2986],[2987,2987]]],[1568078027345,["sirui-php@DESKTOP-PSVFMK8",[[1,3154,"PHP7 中，引用计数器储存在 `value` 中而不是 `zval_struct`"]],[3154,3154],[3196,3196]]],[1568078032604,["sirui-php@DESKTOP-PSVFMK8",[[1,3056,"2"],[-1,3169," "],[1,3170," "],[-1,3177," "],[1,3178," "],[-1,3182," "],[1,3183," "]],[3056,3056],[3057,3057]]],[1568078033075,["sirui-php@DESKTOP-PSVFMK8",[[1,3057,". "]],[3057,3057],[3059,3059]]],[1568078035164,["sirui-php@DESKTOP-PSVFMK8",[[-1,3057,". "]],[3059,3059],[3057,3057]]],[1568078036979,["sirui-php@DESKTOP-PSVFMK8",[[1,3057,". "]],[3057,3057],[3059,3059]]],[1568078040200,["sirui-php@DESKTOP-PSVFMK8",[[1,3055,"\n"]],[3055,3055],[3056,3056]]],[1568078041480,["sirui-php@DESKTOP-PSVFMK8",[[-1,3056," "]],[3057,3057],[3056,3056]]],[1568078043362,["sirui-php@DESKTOP-PSVFMK8",[[1,3157,"3. "]],[3157,3157],[3160,3160]]],[1568078048762,["sirui-php@DESKTOP-PSVFMK8",[[1,3203,"4. \n"]],[3202,3202],[3206,3206]]],[1568078049104,["sirui-php@DESKTOP-PSVFMK8",[[1,3206,"**NULL**、**布尔型**都属于**没有值**的数据类型（其中布尔型通过 `IS_FALSE` 和 `IS_TRUE` 两个常量来标记），自然也就没有引用计数"]],[3206,3206],[3288,3288]]],[1568078053624,["sirui-php@DESKTOP-PSVFMK8",[[1,3289,"5. \n"]],[3288,3288],[3292,3292]]],[1568078054496,["sirui-php@DESKTOP-PSVFMK8",[[1,3292,"**引用**（REFERENCE）变为了一种数据结构而不再只是一个标记位了，它的结构如下："]],[3292,3292],[3337,3337]]],[1568078059953,["sirui-php@DESKTOP-PSVFMK8",[[1,3338,"6. \n"]],[3337,3337],[3341,3341]]],[1568078061377,["sirui-php@DESKTOP-PSVFMK8",[[-1,3338,"6. "]],[3341,3341],[3338,3338]]],[1568078061849,["sirui-php@DESKTOP-PSVFMK8",[[-1,3245," "],[1,3246," "],[-1,3256," 和 "],[1,3259," 和 "],[-1,3268," "],[1,3269," "],[-1,3338,"\n"],[1,3339,"`"]],[3338,3338],[3339,3339]]],[1568078062186,["sirui-php@DESKTOP-PSVFMK8",[[1,3339,"``"]],[3339,3339],[3341,3341]]],[1568078062214,["sirui-php@DESKTOP-PSVFMK8",[[1,3341,"language\n```\n"]],[3341,3341],[3341,3349]]],[1568078062649,["sirui-php@DESKTOP-PSVFMK8",[[-1,3341,"language"],[1,3349,"c"]],[3341,3349],[3342,3342]]],[1568078063112,["sirui-php@DESKTOP-PSVFMK8",[[1,3343,"\n"]],[3342,3342],[3343,3343]]],[1568078063451,["sirui-php@DESKTOP-PSVFMK8",[[1,3343,"struct _zend_reference { zend_refcounted_h gc; zval val; }"]],[3343,3343],[3401,3401]]],[1568078070168,["sirui-php@DESKTOP-PSVFMK8",[[1,3368,"\n"]],[3368,3368],[3369,3369]]],[1568078071096,["sirui-php@DESKTOP-PSVFMK8",[[-1,3369,"z"]],[3369,3369],[3369,3369]]],[1568078071847,["sirui-php@DESKTOP-PSVFMK8",[[1,3369,"z"]],[3369,3369],[3370,3370]]],[1568078073576,["sirui-php@DESKTOP-PSVFMK8",[[1,3400,"\n"]],[3400,3400],[3401,3401]]],[1568078074456,["sirui-php@DESKTOP-PSVFMK8",[[1,3369,"  "]],[3369,3369],[3371,3371]]],[1568078075424,["sirui-php@DESKTOP-PSVFMK8",[[-1,3403," "]],[3404,3404],[3403,3403]]],[1568078077714,["sirui-php@DESKTOP-PSVFMK8",[[1,3409,"\n"]],[3408,3408],[3409,3409]]],[1568078078529,["sirui-php@DESKTOP-PSVFMK8",[[-1,3409,"\n"],[1,3410,"6"]],[3409,3409],[3410,3410]]],[1568078079085,["sirui-php@DESKTOP-PSVFMK8",[[1,3410,". "]],[3410,3410],[3412,3412]]],[1568078119280,["sirui-php@DESKTOP-PSVFMK8",[[-1,3056,"2. `zval_struct.value` 中的 `zend_long` 、`double` 都是**简单数据类型**，能够直接储存具体的值，而其他复杂数据类型储存一个指向其他数据结构的**指针**"],[-1,3157,"3. PHP7 中，引用计数器储存在 `value` 中而不是 `zval_struct`\n4. **NULL**、**布尔型**都属于**没有值**的数据类型（其中布尔型通过 `IS_FALSE` 和 `IS_TRUE` 两个常量来标记），自然也就没有引用计数\n5. **引用**（REFERENCE）变为了一种数据结构而不再只是一个标记位了，它的结构如下：\n```c\nstruct _zend_reference { \n  zend_refcounted_h gc; zval val;\n}\n```\n6. "]],[3056,3412],[3056,3056]]],[1568078120935,["sirui-php@DESKTOP-PSVFMK8",[[1,3057,"\n"]],[3056,3056],[3057,3057]]],[1568078122881,["sirui-php@DESKTOP-PSVFMK8",[[1,2984,"\n"]],[2983,2983],[2984,2984]]],[1568078163313,["sirui-php@DESKTOP-PSVFMK8",[[1,2958,"zhon"]],[2958,2958],[2962,2962]]],[1568078163997,["sirui-php@DESKTOP-PSVFMK8",[[-1,2958,"zhon"]],[2962,2962],[2958,2958]]],[1568078164899,["sirui-php@DESKTOP-PSVFMK8",[[1,2958,"中"]],[2958,2958],[2959,2959]]],[1568078170816,["sirui-php@DESKTOP-PSVFMK8",[[-1,2959," "]],[2960,2960],[2959,2959]]],[1568078196765,["sirui-php@DESKTOP-PSVFMK8",[[-1,3058,"\n"],[1,3059,"找点"]],[3058,3058],[3060,3060]]],[1568078197033,["sirui-php@DESKTOP-PSVFMK8",[[-1,3059,"点"]],[3060,3060],[3059,3059]]],[1568078197166,["sirui-php@DESKTOP-PSVFMK8",[[-1,3058,"找"],[1,3059,"\n"]],[3059,3059],[3058,3058]]],[1568078197371,["sirui-php@DESKTOP-PSVFMK8",[[-1,3058,"\n"]],[3058,3058],[3057,3057]]],[1568078198009,["sirui-php@DESKTOP-PSVFMK8",[[1,3058,"\n"]],[3057,3057],[3058,3058]]],[1568078199036,["sirui-php@DESKTOP-PSVFMK8",[[-1,3058,"\n"],[1,3059,"说明"]],[3058,3058],[3060,3060]]],[1568078213682,["sirui-php@DESKTOP-PSVFMK8",[[1,3060,"：这点并不难理解，每个新建的比那里"]],[3060,3060],[3077,3077]]],[1568078214508,["sirui-php@DESKTOP-PSVFMK8",[[-1,3074,"比那里"]],[3077,3077],[3074,3074]]],[1568078223930,["sirui-php@DESKTOP-PSVFMK8",[[1,3074,"变量都有与其相对应的s"]],[3074,3074],[3085,3085]]],[1568078224359,["sirui-php@DESKTOP-PSVFMK8",[[-1,3084,"s"]],[3085,3085],[3084,3084]]],[1568078225704,["sirui-php@DESKTOP-PSVFMK8",[[1,3084,"zval_"]],[3084,3084],[3089,3089]]],[1568078229210,["sirui-php@DESKTOP-PSVFMK8",[[1,3089,"struct rongq="]],[3089,3089],[3102,3102]]],[1568078230288,["sirui-php@DESKTOP-PSVFMK8",[[-1,3096,"rongq="]],[3102,3102],[3096,3096]]],[1568078231032,["sirui-php@DESKTOP-PSVFMK8",[[1,3096," "]],[3096,3096],[3097,3097]]],[1568078231790,["sirui-php@DESKTOP-PSVFMK8",[[-1,3095,"  "]],[3097,3097],[3095,3095]]],[1568078260541,["sirui-php@DESKTOP-PSVFMK8",[[1,3095,"容器，而变量值则存储于容器中的value, 其中"]],[3095,3095],[3119,3119]]],[1568078277576,["sirui-php@DESKTOP-PSVFMK8",[[-1,3115,", 其中"]],[3119,3119],[3115,3115]]],[1568078277826,["sirui-php@DESKTOP-PSVFMK8",[[1,3115,"\n\n"]],[3115,3115],[3116,3116]]],[1568078765042,["sirui-php@DESKTOP-PSVFMK8",[[-1,3116,"\n"],[1,3117,"！"]],[3116,3116],[3117,3117]]],[1568078765635,["sirui-php@DESKTOP-PSVFMK8",[[-1,3116,"！"],[1,3117,"\n"]],[3117,3117],[3116,3116]]],[1568078766249,["sirui-php@DESKTOP-PSVFMK8",[[-1,3116,"\n"],[1,3117,"!"]],[3116,3116],[3117,3117]]],[1568078766587,["sirui-php@DESKTOP-PSVFMK8",[[1,3117,"["]],[3117,3117],[3118,3118]]],[1568078767841,["sirui-php@DESKTOP-PSVFMK8",[[1,3118,"]("]],[3118,3118],[3120,3120]]],[1568078767869,["sirui-php@DESKTOP-PSVFMK8",[[1,3120,"https://)"]],[3120,3120],[3120,3128]]],[1568078768561,["sirui-php@DESKTOP-PSVFMK8",[[-1,3120,"https://"]],[3120,3128],[3120,3120]]],[1568078768769,["sirui-php@DESKTOP-PSVFMK8",[[1,3120,"http://images.linyiyuan.top/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20190910092340.png"]],[3120,3120],[3203,3203]]],[1568078777561,["sirui-php@DESKTOP-PSVFMK8",[[1,3116,"\n"]],[3115,3115],[3116,3116]]],[1568078779682,["sirui-php@DESKTOP-PSVFMK8",[[1,3205,"\n\n"]],[3205,3205],[3206,3206]]],[1568078779840,["sirui-php@DESKTOP-PSVFMK8",[[1,3207,"\n"]],[3206,3206],[3207,3207]]],[1568078780162,["sirui-php@DESKTOP-PSVFMK8",[[-1,3207,"\n"],[1,3208,"2"]],[3207,3207],[3208,3208]]],[1568078816872,["sirui-php@DESKTOP-PSVFMK8",[[1,3208,". `zval_struct.value` 中的 `zend_long` 、`double` 都是**简单数据类型**，能够直接储存具体的值，而其他复杂数据类型储存一个指向其他数据结构的**指针**\n3. "]],[3208,3208],[3311,3311]]],[1568078817833,["sirui-php@DESKTOP-PSVFMK8",[[-1,3309,". "]],[3311,3311],[3309,3309]]],[1568078818160,["sirui-php@DESKTOP-PSVFMK8",[[-1,3308,"3"],[1,3309,"\n"]],[3309,3309],[3308,3308]]],[1568078818577,["sirui-php@DESKTOP-PSVFMK8",[[-1,3229," 中的 "],[1,3233," 中的 "],[-1,3244," "],[1,3245," "],[-1,3254," "],[1,3255," "],[-1,3308,"\n"],[1,3309,"s"]],[3308,3308],[3309,3309]]],[1568078818699,["sirui-php@DESKTOP-PSVFMK8",[[1,3309,"h"]],[3309,3309],[3310,3310]]],[1568078819200,["sirui-php@DESKTOP-PSVFMK8",[[-1,3309,"h"]],[3310,3310],[3309,3309]]],[1568078819328,["sirui-php@DESKTOP-PSVFMK8",[[-1,3308,"s"],[1,3309,"\n"]],[3309,3309],[3308,3308]]],[1568078819776,["sirui-php@DESKTOP-PSVFMK8",[[1,3309,"\n"]],[3308,3308],[3309,3309]]],[1568078821018,["sirui-php@DESKTOP-PSVFMK8",[[-1,3309,"\n"],[1,3310,"说明"]],[3309,3309],[3311,3311]]],[1568078822344,["sirui-php@DESKTOP-PSVFMK8",[[1,3311,"：即我们在 PHP 中的**整形**与**浮点型**。"]],[3311,3311],[3338,3338]]],[1568078823047,["sirui-php@DESKTOP-PSVFMK8",[[-1,3311,"：即我们在 PHP 中的**整形**与**浮点型**。"]],[3338,3338],[3311,3311]]],[1568078824926,["sirui-php@DESKTOP-PSVFMK8",[[1,3311,"zend"]],[3311,3311],[3315,3315]]],[1568078825962,["sirui-php@DESKTOP-PSVFMK8",[[-1,3311,"zend"]],[3315,3315],[3311,3311]]],[1568078829274,["sirui-php@DESKTOP-PSVFMK8",[[1,3311,"  `zend_long` 、`double` "]],[3311,3311],[3335,3335]]],[1568078830698,["sirui-php@DESKTOP-PSVFMK8",[[1,3311,":"]],[3311,3311],[3312,3312]]],[1568078834555,["sirui-php@DESKTOP-PSVFMK8",[[1,3336," 即我们在 PHP 中的**整形**与**浮点型**。"]],[3336,3336],[3363,3363]]],[1568078855800,["sirui-php@DESKTOP-PSVFMK8",[[-1,3362,"。"]],[3363,3363],[3362,3362]]],[1568078865456,["sirui-php@DESKTOP-PSVFMK8",[[1,3362,", dui"]],[3362,3362],[3367,3367]]],[1568078866151,["sirui-php@DESKTOP-PSVFMK8",[[-1,3364,"dui"]],[3367,3367],[3364,3364]]],[1568078866953,["sirui-php@DESKTOP-PSVFMK8",[[1,3364,"duiyu"]],[3364,3364],[3369,3369]]],[1568078867834,["sirui-php@DESKTOP-PSVFMK8",[[-1,3364,"duiyu"]],[3369,3369],[3364,3364]]],[1568078875833,["sirui-php@DESKTOP-PSVFMK8",[[1,3364,"对于zvalzai"]],[3364,3364],[3373,3373]]],[1568078876503,["sirui-php@DESKTOP-PSVFMK8",[[-1,3370,"zai"]],[3373,3373],[3370,3370]]],[1568078886744,["sirui-php@DESKTOP-PSVFMK8",[[1,3370,"在 value 字段就能直接储存"]],[3370,3370],[3386,3386]]],[1568078899064,["sirui-php@DESKTOP-PSVFMK8",[[1,3366," `"],[-1,3370,"在 "],[1,3372,"` 在 `"],[-1,3377," 字段就能直接储存"],[1,3386,"` 字段中能保存下的值，就不会在对他们进行引用计数，**而是在拷贝的时候直接赋值**"]],[3364,3386],[3424,3424]]],[1568078910175,["sirui-php@DESKTOP-PSVFMK8",[[1,3424,"\n\n"]],[3424,3424],[3425,3425]]],[1568078910585,["sirui-php@DESKTOP-PSVFMK8",[[1,3426,"\n"]],[3425,3425],[3426,3426]]],[1568078910868,["sirui-php@DESKTOP-PSVFMK8",[[-1,3366," "],[1,3367," "],[-1,3373," 在 "],[1,3376," 在 "],[-1,3383," "],[1,3384," "],[-1,3426,"\n"],[1,3427,"3"]],[3426,3426],[3427,3427]]],[1568078933392,["sirui-php@DESKTOP-PSVFMK8",[[1,3427,". PHP7 中，引用计数器储存在 `value` 中而不是 `zval_struct`\n4. **NULL**、**布尔型**都属于**没有值**的数据类型（其中布尔型通过 `IS_FALSE` 和 `IS_TRUE` 两个常量来标记），自然也就没有引用计数\n5. **引用**（REFERENCE）变为了一种数据结构而不再只是一个标记位了，它的结构如下：\n6. struct _zend_reference { zend_refcounted_h gc; zval val; }"]],[3427,3427],[3668,3668]]],[1568078933802,["sirui-php@DESKTOP-PSVFMK8",[[-1,3427,". PHP7 中，引用计数器储存在 `value` 中而不是 `zval_struct`\n4. **NULL**、**布尔型**都属于**没有值**的数据类型（其中布尔型通过 `IS_FALSE` 和 `IS_TRUE` 两个常量来标记），自然也就没有引用计数\n5. **引用**（REFERENCE）变为了一种数据结构而不再只是一个标记位了，它的结构如下：\n6. struct _zend_reference { zend_refcounted_h gc; zval val; }"]],[3668,3668],[3427,3427]]],[1568078937783,["sirui-php@DESKTOP-PSVFMK8",[[1,3366," "],[-1,3366," "],[1,3373," 在 "],[-1,3373," 在 "],[1,3383," "],[-1,3383," "],[1,3426,"\n"],[-1,3426,"3"]],[3427,3427],[3426,3426]]],[1568078938230,["sirui-php@DESKTOP-PSVFMK8",[[-1,3426,"\n"]],[3426,3426],[3425,3425]]],[1568078940136,["sirui-php@DESKTOP-PSVFMK8",[[1,3425,"* [ ] "]],[3425,3425],[3431,3431]]],[1568078952681,["sirui-php@DESKTOP-PSVFMK8",[[-1,3425,"* [ ] "]],[3431,3431],[3425,3425]]],[1568078954161,["sirui-php@DESKTOP-PSVFMK8",[[1,3425,"* [ ] "]],[3425,3425],[3431,3431]]],[1568078955530,["sirui-php@DESKTOP-PSVFMK8",[[-1,3425,"* [ ] "]],[3431,3431],[3425,3425]]],[1568078957072,["sirui-php@DESKTOP-PSVFMK8",[[1,3425,"* [ ] "]],[3425,3425],[3431,3431]]],[1568078958673,["sirui-php@DESKTOP-PSVFMK8",[[-1,3425,"* [ ] "]],[3431,3431],[3425,3425]]],[1568078982151,["sirui-php@DESKTOP-PSVFMK8",[[1,3425,"* [ ] "]],[3425,3425],[3431,3431]]],[1568078983441,["sirui-php@DESKTOP-PSVFMK8",[[-1,3425,"* [ ] "]],[3431,3431],[3425,3425]]],[1568078987858,["sirui-php@DESKTOP-PSVFMK8",[[1,3425,"PHP7 中，引用计数器储存在 `value` 中而不是 `zval_struct`"]],[3425,3425],[3467,3467]]],[1568078988666,["sirui-php@DESKTOP-PSVFMK8",[[-1,3425,"PHP7 中，引用计数器储存在 `value` 中而不是 `zval_struct`"]],[3467,3467],[3425,3425]]],[1568078989604,["sirui-php@DESKTOP-PSVFMK8",[[-1,3366," "],[1,3367," "],[-1,3373," 在 "],[1,3376," 在 "],[-1,3383," "],[1,3384," "],[-1,3425,"\n"],[1,3426,"3"]],[3425,3425],[3426,3426]]],[1568078990876,["sirui-php@DESKTOP-PSVFMK8",[[1,3426,". PHP7 中，引用计数器储存在 `value` 中而不是 `zval_struct`"]],[3426,3426],[3470,3470]]],[1568079009472,["sirui-php@DESKTOP-PSVFMK8",[[-1,3057,"\n"]],[3057,3057],[3056,3056]]],[1568079011264,["sirui-php@DESKTOP-PSVFMK8",[[1,3057,"2. \n"]],[3056,3056],[3060,3060]]],[1568079012538,["sirui-php@DESKTOP-PSVFMK8",[[-1,3057,"2. \n"]],[3060,3060],[3056,3056]]],[1568079013078,["sirui-php@DESKTOP-PSVFMK8",[[1,3057,"2. \n"]],[3056,3056],[3060,3060]]],[1568079014968,["sirui-php@DESKTOP-PSVFMK8",[[-1,3057,"2."]],[3059,3059],[3057,3057]]],[1568079019586,["sirui-php@DESKTOP-PSVFMK8",[[1,3426,"\n"]],[3425,3425],[3426,3426]]],[1568079030745,["sirui-php@DESKTOP-PSVFMK8",[[1,3472,"\n4. **NULL**、**布尔型**都属于**没有值**的数据类型（其中布尔型通过 `IS_FALSE` 和 `IS_TRUE` 两个常量来标记），自然也就没有引用计数\n5. 1.  **引用**（REFERENCE）变为了一种数据结构而不再只是一个标记位了，它的结构如下：\n\n```\nstruct _zend_reference {\n    zend_refcounted_h gc;\n    zval              val;\n}\n```"]],[3472,3472],[3700,3700]]],[1568079034431,["sirui-php@DESKTOP-PSVFMK8",[[-1,3561," 1.  "]],[3566,3566],[3561,3561]]],[1568079035277,["sirui-php@DESKTOP-PSVFMK8",[[-1,3445," "],[1,3446," "],[-1,3453," "],[1,3454," "],[-1,3458," "],[1,3459," "],[-1,3515," "],[1,3516," "],[-1,3526," 和 "],[1,3529," 和 "],[-1,3538," "],[1,3539," "],[1,3561," "]],[3561,3561],[3562,3562]]],[1568079038125,["sirui-php@DESKTOP-PSVFMK8",[[1,3612,"c"]],[3612,3612],[3613,3613]]],[1568079044763,["sirui-php@DESKTOP-PSVFMK8",[[1,3697,"\n\n"]],[3697,3697],[3698,3698]]],[1568079045995,["sirui-php@DESKTOP-PSVFMK8",[[-1,3698,"\n"],[1,3699,"6"]],[3698,3698],[3699,3699]]],[1568079046651,["sirui-php@DESKTOP-PSVFMK8",[[1,3699,". `zend_reference` 作为 `zval_struct` 中包含的一种 `value` 类型，也拥有自己的 `val` 值，这个值是指向一个 `zval_struct.value` 的。他们都拥有自己的**引用计数器**。"]],[3699,3699],[3817,3817]]],[1568079130592,["sirui-php@DESKTOP-PSVFMK8",[[1,3817,"\n7. "]],[3817,3817],[3821,3821]]],[1568079131555,["sirui-php@DESKTOP-PSVFMK8",[[-1,3819,". "]],[3821,3821],[3819,3819]]],[1568079131851,["sirui-php@DESKTOP-PSVFMK8",[[-1,3818,"7"],[1,3819,"\n"]],[3819,3819],[3818,3818]]],[1568079132778,["sirui-php@DESKTOP-PSVFMK8",[[1,3818,"    "]],[3818,3818],[3822,3822]]],[1568079133176,["sirui-php@DESKTOP-PSVFMK8",[[-1,3818,"    "],[1,3822,"\n"]],[3822,3822],[3819,3819]]],[1568079134176,["sirui-php@DESKTOP-PSVFMK8",[[1,3819,"    引用计数器用来记录当前有多少 `zval` 指向同一个 `zend_value`。"]],[3819,3819],[3864,3864]]],[1568079137242,["sirui-php@DESKTOP-PSVFMK8",[[1,3865,"    \n"]],[3864,3864],[3869,3869]]],[1568079138598,["sirui-php@DESKTOP-PSVFMK8",[[-1,3865,"    \n"]],[3869,3869],[3864,3864]]],[1568079139497,["sirui-php@DESKTOP-PSVFMK8",[[1,3865,"    \n"]],[3864,3864],[3869,3869]]],[1568079139801,["sirui-php@DESKTOP-PSVFMK8",[[-1,3865,"    "],[1,3869,"\n"]],[3869,3869],[3866,3866]]],[1568079144733,["sirui-php@DESKTOP-PSVFMK8",[[-1,3717," 作为 "],[1,3721," 作为 "],[-1,3734," "],[1,3735," "],[-1,3741," "],[1,3742," "],[-1,3749," "],[1,3750," "],[-1,3759," "],[1,3760," "],[-1,3765," "],[1,3766," "],[-1,3776," "],[1,3777," "],[-1,3796," "],[1,3797," "],[-1,3837," "],[1,3838," "],[-1,3844," "],[1,3845," "],[-1,3850," "],[1,3851," "],[-1,3866,"\n"],[1,3867,"y"]],[3866,3866],[3867,3867]]],[1568079144801,["sirui-php@DESKTOP-PSVFMK8",[[1,3867,"i"]],[3867,3867],[3868,3868]]],[1568079145376,["sirui-php@DESKTOP-PSVFMK8",[[-1,3867,"i"]],[3868,3868],[3867,3867]]],[1568079145496,["sirui-php@DESKTOP-PSVFMK8",[[-1,3866,"y"],[1,3867,"\n"]],[3867,3867],[3866,3866]]],[1568079146467,["sirui-php@DESKTOP-PSVFMK8",[[-1,3866,"\n"],[1,3867,"以上"]],[3866,3866],[3868,3868]]],[1568079158906,["sirui-php@DESKTOP-PSVFMK8",[[1,3868,"六点就是对zvalde "]],[3868,3868],[3880,3880]]],[1568079159601,["sirui-php@DESKTOP-PSVFMK8",[[-1,3877,"de "]],[3880,3880],[3877,3877]]],[1568079165879,["sirui-php@DESKTOP-PSVFMK8",[[1,3877,"容器的概括"]],[3877,3877],[3882,3882]]],[1568079166306,["sirui-php@DESKTOP-PSVFMK8",[[-1,3880,"概括"]],[3882,3882],[3880,3880]]],[1568079167651,["sirui-php@DESKTOP-PSVFMK8",[[1,3880,"总结"]],[3880,3880],[3882,3882]]],[1568079169395,["sirui-php@DESKTOP-PSVFMK8",[[1,3880,"管家"]],[3880,3880],[3882,3882]]],[1568079169952,["sirui-php@DESKTOP-PSVFMK8",[[-1,3880,"管家"]],[3882,3882],[3880,3880]]],[1568079172051,["sirui-php@DESKTOP-PSVFMK8",[[1,3880,"更新"]],[3880,3880],[3882,3882]]],[1568079173915,["sirui-php@DESKTOP-PSVFMK8",[[1,3884,"，而"]],[3884,3884],[3886,3886]]],[1568079218259,["sirui-php@DESKTOP-PSVFMK8",[[1,3886,"针对第六点，我们使用代码进行讲解："]],[3886,3886],[3903,3903]]],[1568079218640,["sirui-php@DESKTOP-PSVFMK8",[[1,3903,"\n\n"]],[3903,3903],[3904,3904]]],[1568079221696,["sirui-php@DESKTOP-PSVFMK8",[[-1,3904,"\n"]],[3904,3904],[3903,3903]]],[1568079226541,["sirui-php@DESKTOP-PSVFMK8",[[1,3903,"请看如下代码："]],[3903,3903],[3910,3910]]],[1568079226800,["sirui-php@DESKTOP-PSVFMK8",[[1,3911,"\n"]],[3910,3910],[3911,3911]]],[1568079229937,["sirui-php@DESKTOP-PSVFMK8",[[1,3911,"$a = 'foo'; $b = &$a; $c = $a;"]],[3911,3911],[3941,3941]]],[1568079230826,["sirui-php@DESKTOP-PSVFMK8",[[-1,3911,"$a = 'foo'; $b = &$a; $c = $a;"]],[3941,3941],[3911,3911]]],[1568079231257,["sirui-php@DESKTOP-PSVFMK8",[[1,3912,"\n"]],[3911,3911],[3912,3912]]],[1568079231843,["sirui-php@DESKTOP-PSVFMK8",[[-1,3912,"\n"],[1,3913,"`"]],[3912,3912],[3913,3913]]],[1568079232196,["sirui-php@DESKTOP-PSVFMK8",[[1,3913,"``"]],[3913,3913],[3915,3915]]],[1568079232226,["sirui-php@DESKTOP-PSVFMK8",[[1,3915,"language\n```\n"]],[3915,3915],[3915,3923]]],[1568079233083,["sirui-php@DESKTOP-PSVFMK8",[[-1,3915,"language"],[1,3923,"p"]],[3915,3923],[3916,3916]]],[1568079233356,["sirui-php@DESKTOP-PSVFMK8",[[1,3916,"hp"]],[3916,3916],[3918,3918]]],[1568079233634,["sirui-php@DESKTOP-PSVFMK8",[[1,3919,"\n"]],[3918,3918],[3919,3919]]],[1568079233888,["sirui-php@DESKTOP-PSVFMK8",[[1,3919,"$a = 'foo'; $b = &$a; $c = $a;"]],[3919,3919],[3949,3949]]],[1568079237104,["sirui-php@DESKTOP-PSVFMK8",[[1,3931,"\n"]],[3931,3931],[3932,3932]]],[1568079237688,["sirui-php@DESKTOP-PSVFMK8",[[1,3932,"\n"]],[3932,3932],[3933,3933]]],[1568079239816,["sirui-php@DESKTOP-PSVFMK8",[[1,3942,"\n"]],[3942,3942],[3943,3943]]],[1568079240024,["sirui-php@DESKTOP-PSVFMK8",[[1,3943,"\n "]],[3943,3943],[3945,3945]]],[1568079240867,["sirui-php@DESKTOP-PSVFMK8",[[-1,3945," "]],[3945,3945],[3944,3944]]],[1568079241576,["sirui-php@DESKTOP-PSVFMK8",[[-1,3944," "]],[3945,3945],[3944,3944]]],[1568079245369,["sirui-php@DESKTOP-PSVFMK8",[[1,3957,"\n"]],[3956,3956],[3957,3957]]],[1568079245777,["sirui-php@DESKTOP-PSVFMK8",[[1,3958,"\n"]],[3957,3957],[3958,3958]]],[1568079247475,["sirui-php@DESKTOP-PSVFMK8",[[-1,3958,"\n"],[1,3959,"这是"]],[3958,3958],[3960,3960]]],[1568079274184,["sirui-php@DESKTOP-PSVFMK8",[[1,3960,"一段相对简单的赋值引用代码，  此时$a "]],[3960,3960],[3981,3981]]],[1568079274592,["sirui-php@DESKTOP-PSVFMK8",[[-1,3980," "]],[3981,3981],[3980,3980]]],[1568079280917,["sirui-php@DESKTOP-PSVFMK8",[[1,3980,", $b 各自用欧"]],[3980,3980],[3989,3989]]],[1568079281484,["sirui-php@DESKTOP-PSVFMK8",[[-1,3987,"用欧"]],[3989,3989],[3987,3987]]],[1568079292891,["sirui-php@DESKTOP-PSVFMK8",[[1,3987,"拥有一个zval_stur"]],[3987,3987],[4000,4000]]],[1568079293488,["sirui-php@DESKTOP-PSVFMK8",[[-1,3998,"ur"]],[4000,4000],[3998,3998]]],[1568079302080,["sirui-php@DESKTOP-PSVFMK8",[[1,3998,"ruct容器："]],[3998,3998],[4005,4005]]],[1568079302416,["sirui-php@DESKTOP-PSVFMK8",[[1,4005,"\n\n"]],[4005,4005],[4006,4006]]],[1568080239050,["sirui-php@DESKTOP-PSVFMK8",[[1,4005,"$a 与 $b 各拥有一个 `zval_struct` 容器，并且其中的 `value` 都指向同一个 `zend_reference` 结构，`zend_reference` 内嵌一个 `val` 结构， 指向同一个 `zend_string`，**字符串的内容**就储存在其中。\n\n而 $c 也拥有一个 `zval_struct`，而它的 value 在初始化的时候可以直接指向上面提到的 `zend_string` ，这样在拷贝时就不会产生复制。\n\n作者：Gtaker\n链接：https://juejin.im/post/5bbf50e86fb9a05ce02a9c19\n来源：掘金\n著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"]],[4005,4005],[4334,4334]]],[1568080242604,["sirui-php@DESKTOP-PSVFMK8",[[-1,3958,"这是一段相对简单的赋值引用代码，  此时$a, $b 各自拥有一个zval_struct容器："],[1,4232,"\n作者：Gtaker\n链接：https://juejin.im/post/5bbf50e86fb9a05ce02a9c19\n来源：掘金\n著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"]],[3958,4232],[4287,4287]]],[1568080243834,["sirui-php@DESKTOP-PSVFMK8",[[1,3958,"这是一段相对简单的赋值引用代码，  此时$a, $b 各自拥有一个zval_struct容器："],[-1,4185,"\n作者：Gtaker\n链接：https://juejin.im/post/5bbf50e86fb9a05ce02a9c19\n来源：掘金\n著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"]],[4287,4287],[3958,4232]]],[1568080246260,["sirui-php@DESKTOP-PSVFMK8",[[-1,3958,"这是一段相对简单的赋值引用代码，  此时$a, $b 各自拥有一个zval_struct容器："],[1,4232,"\n作者：Gtaker\n链接：https://juejin.im/post/5bbf50e86fb9a05ce02a9c19\n来源：掘金\n著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"]],[3958,4232],[4287,4287]]],[1568080248409,["sirui-php@DESKTOP-PSVFMK8",[[-1,4186,"作者：Gtaker\n链接：https://juejin.im/post/5bbf50e86fb9a05ce02a9c19\n来源：掘金\n著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。\n作者：Gtaker\n链接：https://juejin.im/post/5bbf50e86fb9a05ce02a9c19\n来源：掘金\n著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。\n"]],[4186,4390],[4186,4186]]],[1568080248673,["sirui-php@DESKTOP-PSVFMK8",[[-1,4186,"\n"]],[4186,4186],[4185,4185]]],[1568080261441,["sirui-php@DESKTOP-PSVFMK8",[[1,4186,"\n"]],[4185,4185],[4186,4186]]],[1568080263063,["sirui-php@DESKTOP-PSVFMK8",[[-1,4186,"\n"]],[4186,4186],[4185,4185]]],[1568080263438,["sirui-php@DESKTOP-PSVFMK8",[[-1,4185,"\n"],[1,4186,"！"]],[4185,4185],[4186,4186]]],[1568080264065,["sirui-php@DESKTOP-PSVFMK8",[[-1,4185,"！"],[1,4186,"\n"]],[4186,4186],[4185,4185]]],[1568080264719,["sirui-php@DESKTOP-PSVFMK8",[[-1,4185,"\n"],[1,4186,"!"]],[4185,4185],[4186,4186]]],[1568080266189,["sirui-php@DESKTOP-PSVFMK8",[[1,4186,"[]("]],[4186,4186],[4189,4189]]],[1568080266220,["sirui-php@DESKTOP-PSVFMK8",[[1,4189,"https://)"]],[4189,4189],[4189,4197]]],[1568080267041,["sirui-php@DESKTOP-PSVFMK8",[[-1,4189,"https://"]],[4189,4197],[4189,4189]]],[1568080270279,["sirui-php@DESKTOP-PSVFMK8",[[1,4189,"$a 与 $b 各拥有一个 `zval_struct` 容器，并且其中的 `value` 都指向同一个 `zend_reference` 结构，`zend_reference` 内嵌一个 `val` 结构， 指向同一个 `zend_string`，**字符串的内容**就储存在其中。\n\n而 $c 也拥有一个 `zval_struct`，而它的 value 在初始化的时候可以直接指向上面提到的 `zend_string` ，这样在拷贝时就不会产生复制。\n\n作者：Gtaker\n链接：https://juejin.im/post/5bbf50e86fb9a05ce02a9c19\n来源：掘金\n著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"]],[4189,4189],[4518,4518]]],[1568080270815,["sirui-php@DESKTOP-PSVFMK8",[[-1,4189,"$a 与 $b 各拥有一个 `zval_struct` 容器，并且其中的 `value` 都指向同一个 `zend_reference` 结构，`zend_reference` 内嵌一个 `val` 结构， 指向同一个 `zend_string`，**字符串的内容**就储存在其中。\n\n而 $c 也拥有一个 `zval_struct`，而它的 value 在初始化的时候可以直接指向上面提到的 `zend_string` ，这样在拷贝时就不会产生复制。\n\n作者：Gtaker\n链接：https://juejin.im/post/5bbf50e86fb9a05ce02a9c19\n来源：掘金\n著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"]],[4518,4518],[4189,4189]]],[1568080277041,["sirui-php@DESKTOP-PSVFMK8",[[1,4189,"http://images.linyiyuan.top/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20190910094943.png"]],[4189,4189],[4272,4272]]],[1568080393281,["sirui-php@DESKTOP-PSVFMK8",[[1,1317,"\n"]],[1315,1315],[1316,1316]]],[1568080393713,["sirui-php@DESKTOP-PSVFMK8",[[1,1318,"\n"]],[1316,1316],[1317,1317]]],[1568080400981,["sirui-php@DESKTOP-PSVFMK8",[[1,1317,"## Zvalrong"]],[1317,1317],[1328,1328]]],[1568080401746,["sirui-php@DESKTOP-PSVFMK8",[[-1,1324,"rong"]],[1328,1328],[1324,1324]]],[1568080403091,["sirui-php@DESKTOP-PSVFMK8",[[1,1324,"rong"]],[1324,1324],[1328,1328]]],[1568080403858,["sirui-php@DESKTOP-PSVFMK8",[[-1,1324,"rong"]],[1328,1328],[1324,1324]]],[1568080404039,["sirui-php@DESKTOP-PSVFMK8",[[1,1324," "]],[1324,1324],[1325,1325]]],[1568080404889,["sirui-php@DESKTOP-PSVFMK8",[[-1,1324," "]],[1325,1325],[1324,1324]]],[1568080405182,["sirui-php@DESKTOP-PSVFMK8",[[1,1324,"q"]],[1324,1324],[1325,1325]]],[1568080405745,["sirui-php@DESKTOP-PSVFMK8",[[-1,1324,"q"]],[1325,1325],[1324,1324]]],[1568080407044,["sirui-php@DESKTOP-PSVFMK8",[[1,1324,"容器"]],[1324,1324],[1326,1326]]],[1568080705604,["sirui-php@DESKTOP-PSVFMK8",[[1,4284,"\n\n"]],[4284,4284],[4285,4285]]],[1568080705801,["sirui-php@DESKTOP-PSVFMK8",[[1,4286,"\n"]],[4285,4285],[4286,4286]]],[1568080706399,["sirui-php@DESKTOP-PSVFMK8",[[-1,4286,"\n"],[1,4287,"r"]],[4286,4286],[4287,4287]]],[1568080706907,["sirui-php@DESKTOP-PSVFMK8",[[1,4287,"anho"]],[4287,4287],[4291,4291]]],[1568080707625,["sirui-php@DESKTOP-PSVFMK8",[[-1,4287,"anho"]],[4291,4291],[4287,4287]]],[1568080707785,["sirui-php@DESKTOP-PSVFMK8",[[-1,4286,"r"],[1,4287,"\n"]],[4287,4287],[4286,4286]]],[1568080709111,["sirui-php@DESKTOP-PSVFMK8",[[-1,4286,"\n"],[1,4287,"然后"]],[4286,4286],[4288,4288]]],[1568080722183,["sirui-php@DESKTOP-PSVFMK8",[[1,4288,"我们使用xdebug_debug_zval 打印"]],[4288,4288],[4312,4312]]],[1568080722604,["sirui-php@DESKTOP-PSVFMK8",[[-1,4310,"打印"]],[4312,4312],[4310,4310]]],[1568080724395,["sirui-php@DESKTOP-PSVFMK8",[[1,4310,"输出"]],[4310,4310],[4312,4312]]],[1568080729989,["sirui-php@DESKTOP-PSVFMK8",[[-1,4287,"后我们使用xdebug_debug_zval 输出"]],[4292,4312],[4287,4287]]],[1568080730121,["sirui-php@DESKTOP-PSVFMK8",[[-1,4286,"然"],[1,4287,"\n"]],[4287,4287],[4286,4286]]],[1568080730409,["sirui-php@DESKTOP-PSVFMK8",[[-1,4286,"\n"]],[4286,4286],[4285,4285]]],[1568080732770,["sirui-php@DESKTOP-PSVFMK8",[[1,3964,"\n"]],[3963,3963],[3964,3964]]],[1568080732906,["sirui-php@DESKTOP-PSVFMK8",[[1,3965,"\n"]],[3964,3964],[3965,3965]]],[1568080738410,["sirui-php@DESKTOP-PSVFMK8",[[1,3965,"xdebug_debug_zval('a');\nxdebug_debug_zval('b');\nxdebug_debug_zval('c');"]],[3965,3965],[4036,4036]]],[1568080740505,["sirui-php@DESKTOP-PSVFMK8",[[1,4359,"\n"]],[4358,4358],[4359,4359]]],[1568080741215,["sirui-php@DESKTOP-PSVFMK8",[[-1,4359,"\n"],[1,4360,"r"]],[4359,4359],[4360,4360]]],[1568080741547,["sirui-php@DESKTOP-PSVFMK8",[[1,4360,"anh"]],[4360,4360],[4363,4363]]],[1568080742139,["sirui-php@DESKTOP-PSVFMK8",[[-1,4360,"anh"]],[4363,4363],[4360,4360]]],[1568080742289,["sirui-php@DESKTOP-PSVFMK8",[[-1,4359,"r"],[1,4360,"\n"]],[4360,4360],[4359,4359]]],[1568080742605,["sirui-php@DESKTOP-PSVFMK8",[[-1,4359,"\n"],[1,4360,"r"]],[4359,4359],[4360,4360]]],[1568080742970,["sirui-php@DESKTOP-PSVFMK8",[[1,4360,"anh"]],[4360,4360],[4363,4363]]],[1568080743573,["sirui-php@DESKTOP-PSVFMK8",[[-1,4360,"anh"]],[4363,4363],[4360,4360]]],[1568080743721,["sirui-php@DESKTOP-PSVFMK8",[[-1,4359,"r"],[1,4360,"\n"]],[4360,4360],[4359,4359]]],[1568080744077,["sirui-php@DESKTOP-PSVFMK8",[[-1,4359,"\n"],[1,4360,"r"]],[4359,4359],[4360,4360]]],[1568080744230,["sirui-php@DESKTOP-PSVFMK8",[[1,4360,"an"]],[4360,4360],[4362,4362]]],[1568080744801,["sirui-php@DESKTOP-PSVFMK8",[[-1,4360,"an"]],[4362,4362],[4360,4360]]],[1568080744953,["sirui-php@DESKTOP-PSVFMK8",[[-1,4359,"r"],[1,4360,"\n"]],[4360,4360],[4359,4359]]],[1568080745817,["sirui-php@DESKTOP-PSVFMK8",[[-1,4359,"\n"]],[4359,4359],[4358,4358]]],[1568080747012,["sirui-php@DESKTOP-PSVFMK8",[[1,4359,"\n"]],[4358,4358],[4359,4359]]],[1568080747916,["sirui-php@DESKTOP-PSVFMK8",[[-1,4359,"\n"],[1,4360,"然后"]],[4359,4359],[4361,4361]]],[1568080752453,["sirui-php@DESKTOP-PSVFMK8",[[1,4361,"我们运行代码："]],[4361,4361],[4368,4368]]],[1568080753483,["sirui-php@DESKTOP-PSVFMK8",[[1,4368,"\n\n"]],[4368,4368],[4369,4369]]],[1568080822606,["sirui-php@DESKTOP-PSVFMK8",[[-1,4369,"\n"],[1,4370,"!"]],[4369,4369],[4370,4370]]],[1568080823921,["sirui-php@DESKTOP-PSVFMK8",[[1,4370,"[]("]],[4370,4370],[4373,4373]]],[1568080823951,["sirui-php@DESKTOP-PSVFMK8",[[1,4373,"https://)"]],[4373,4373],[4373,4381]]],[1568080824449,["sirui-php@DESKTOP-PSVFMK8",[[-1,4373,"https://"]],[4373,4381],[4373,4373]]],[1568080824705,["sirui-php@DESKTOP-PSVFMK8",[[1,4373,"http://images.linyiyuan.top/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20190910095938.png"]],[4373,4373],[4456,4456]]],[1568080827144,["sirui-php@DESKTOP-PSVFMK8",[[1,4457,"\n\n"]],[4457,4457],[4458,4458]]],[1568080827593,["sirui-php@DESKTOP-PSVFMK8",[[1,4459,"\n"]],[4458,4458],[4459,4459]]],[1568080897340,["sirui-php@DESKTOP-PSVFMK8",[[-1,4459,"\n"],[1,4460,"c"]],[4459,4459],[4460,4460]]],[1568080897588,["sirui-php@DESKTOP-PSVFMK8",[[1,4460,"ong"]],[4460,4460],[4463,4463]]],[1568080898425,["sirui-php@DESKTOP-PSVFMK8",[[-1,4460,"ong"]],[4463,4463],[4460,4460]]],[1568080898577,["sirui-php@DESKTOP-PSVFMK8",[[-1,4459,"c"],[1,4460,"\n"]],[4460,4460],[4459,4459]]],[1568080899907,["sirui-php@DESKTOP-PSVFMK8",[[-1,4459,"\n"],[1,4460,"从"]],[4459,4459],[4460,4460]]],[1568080907690,["sirui-php@DESKTOP-PSVFMK8",[[1,4460,"图中不难发现，$a跟$a"]],[4460,4460],[4472,4472]]],[1568080908041,["sirui-php@DESKTOP-PSVFMK8",[[-1,4471,"a"]],[4472,4472],[4471,4471]]],[1568080913885,["sirui-php@DESKTOP-PSVFMK8",[[1,4471,"b 的引用计数为"]],[4471,4471],[4479,4479]]],[1568080915194,["sirui-php@DESKTOP-PSVFMK8",[[-1,4474,"引用计数为"]],[4479,4479],[4474,4474]]],[1568080916051,["sirui-php@DESKTOP-PSVFMK8",[[1,4474,"``"]],[4474,4474],[4476,4476]]],[1568080918459,["sirui-php@DESKTOP-PSVFMK8",[[1,4475,"refcount"]],[4475,4475],[4483,4483]]],[1568080919826,["sirui-php@DESKTOP-PSVFMK8",[[1,4484," wei"]],[4484,4484],[4488,4488]]],[1568080920721,["sirui-php@DESKTOP-PSVFMK8",[[-1,4485,"wei"]],[4488,4488],[4485,4485]]],[1568080927987,["sirui-php@DESKTOP-PSVFMK8",[[1,4485,"为2，$c为1，"]],[4485,4485],[4493,4493]]],[1568080943764,["sirui-php@DESKTOP-PSVFMK8",[[1,4493,"我们根据第五第六的"]],[4493,4493],[4502,4502]]],[1568080946050,["sirui-php@DESKTOP-PSVFMK8",[[-1,4499,"第六的"]],[4502,4502],[4499,4499]]],[1568080992730,["sirui-php@DESKTOP-PSVFMK8",[[1,4499,"点以及第六点可以知道 $a"]],[4499,4499],[4512,4512]]],[1568080995186,["sirui-php@DESKTOP-PSVFMK8",[[1,4512,"跟$a"]],[4512,4512],[4515,4515]]],[1568080995507,["sirui-php@DESKTOP-PSVFMK8",[[-1,4514,"a"]],[4515,4515],[4514,4514]]],[1568080995852,["sirui-php@DESKTOP-PSVFMK8",[[1,4514,"b "]],[4514,4514],[4516,4516]]],[1568080996528,["sirui-php@DESKTOP-PSVFMK8",[[-1,4515," "]],[4516,4516],[4515,4515]]],[1568081001439,["sirui-php@DESKTOP-PSVFMK8",[[1,4515,"都指向zend"]],[4515,4515],[4522,4522]]],[1568081002105,["sirui-php@DESKTOP-PSVFMK8",[[-1,4518,"zend"]],[4522,4522],[4518,4518]]],[1568081003474,["sirui-php@DESKTOP-PSVFMK8",[[1,4518,"容一个"]],[4518,4518],[4521,4521]]],[1568081004096,["sirui-php@DESKTOP-PSVFMK8",[[-1,4518,"容一个"]],[4521,4521],[4518,4518]]],[1568081008435,["sirui-php@DESKTOP-PSVFMK8",[[1,4518,"同一个zend_ref"]],[4518,4518],[4529,4529]]],[1568081015048,["sirui-php@DESKTOP-PSVFMK8",[[-1,4521,"zend_ref"]],[4529,4529],[4521,4521]]],[1568081015546,["sirui-php@DESKTOP-PSVFMK8",[[1,4521,"``"]],[4521,4521],[4523,4523]]],[1568081016057,["sirui-php@DESKTOP-PSVFMK8",[[1,4522,"zend_reference"]],[4522,4522],[4536,4536]]],[1568081018547,["sirui-php@DESKTOP-PSVFMK8",[[1,4521," "]],[4521,4521],[4522,4522]]],[1568081037110,["sirui-php@DESKTOP-PSVFMK8",[[1,4538," 所以他们的refcount为2,er"]],[4538,4538],[4557,4557]]],[1568081037512,["sirui-php@DESKTOP-PSVFMK8",[[-1,4555,"er"]],[4557,4557],[4555,4555]]],[1568081041102,["sirui-php@DESKTOP-PSVFMK8",[[1,4555," 而$c是"]],[4555,4555],[4560,4560]]],[1568081044905,["sirui-php@DESKTOP-PSVFMK8",[[-1,4554,", 而$c是"]],[4560,4560],[4554,4554]]],[1568081093068,["sirui-php@DESKTOP-PSVFMK8",[[1,4554," 而``"]],[4554,4554],[4558,4558]]],[1568081096386,["sirui-php@DESKTOP-PSVFMK8",[[1,4557,"zend_reference"]],[4557,4557],[4571,4571]]],[1568081099151,["sirui-php@DESKTOP-PSVFMK8",[[1,4572," 的结构体"]],[4572,4572],[4577,4577]]],[1568081100578,["sirui-php@DESKTOP-PSVFMK8",[[-1,4574,"结构体"]],[4577,4577],[4574,4574]]],[1568081104059,["sirui-php@DESKTOP-PSVFMK8",[[1,4574,"结构包含"]],[4574,4574],[4578,4578]]],[1568081106459,["sirui-php@DESKTOP-PSVFMK8",[[1,4555," "]],[4555,4555],[4556,4556]]],[1568081107340,["sirui-php@DESKTOP-PSVFMK8",[[-1,4556,"而"]],[4557,4557],[4556,4556]]],[1568081123214,["sirui-php@DESKTOP-PSVFMK8",[[1,4578," gc"]],[4578,4578],[4581,4581]]],[1568081130481,["sirui-php@DESKTOP-PSVFMK8",[[-1,4578," "]],[4579,4579],[4578,4578]]],[1568081132315,["sirui-php@DESKTOP-PSVFMK8",[[1,4580," qi"]],[4580,4580],[4583,4583]]],[1568081132936,["sirui-php@DESKTOP-PSVFMK8",[[-1,4581,"qi"]],[4583,4583],[4581,4581]]],[1568081143156,["sirui-php@DESKTOP-PSVFMK8",[[1,4581,"其gc 就是··"]],[4581,4581],[4589,4589]]],[1568081143730,["sirui-php@DESKTOP-PSVFMK8",[[-1,4587,"··"]],[4589,4589],[4587,4587]]],[1568081144411,["sirui-php@DESKTOP-PSVFMK8",[[1,4587,"··"]],[4587,4587],[4589,4589]]],[1568081145526,["sirui-php@DESKTOP-PSVFMK8",[[-1,4587,"··"]],[4589,4589],[4587,4587]]],[1568081146182,["sirui-php@DESKTOP-PSVFMK8",[[1,4587,"``"]],[4587,4587],[4589,4589]]],[1568081148274,["sirui-php@DESKTOP-PSVFMK8",[[1,4588," _zend_refcounted_h "]],[4588,4588],[4608,4608]]],[1568081149925,["sirui-php@DESKTOP-PSVFMK8",[[1,4609,"的一个"]],[4609,4609],[4612,4612]]],[1568081150858,["sirui-php@DESKTOP-PSVFMK8",[[-1,4610,"一个"]],[4612,4612],[4610,4610]]],[1568081159686,["sirui-php@DESKTOP-PSVFMK8",[[1,4610,"结构体 主要作用"]],[4610,4610],[4618,4618]]],[1568081166538,["sirui-php@DESKTOP-PSVFMK8",[[-1,4614,"主要作用"]],[4618,4618],[4614,4614]]],[1568081166732,["sirui-php@DESKTOP-PSVFMK8",[[1,4614,"主要作用是引用计数以及标记变量的类别"]],[4614,4614],[4632,4632]]],[1568081173212,["sirui-php@DESKTOP-PSVFMK8",[[1,4632,"\n\n"]],[4632,4632],[4633,4633]]],[1568081173458,["sirui-php@DESKTOP-PSVFMK8",[[1,4634,"\n"]],[4633,4633],[4634,4634]]],[1568081173972,["sirui-php@DESKTOP-PSVFMK8",[[-1,4634,"\n"],[1,4635,"`"]],[4634,4634],[4635,4635]]],[1568081174262,["sirui-php@DESKTOP-PSVFMK8",[[1,4635,"``"]],[4635,4635],[4637,4637]]],[1568081174295,["sirui-php@DESKTOP-PSVFMK8",[[1,4637,"language\n```\n"]],[4637,4637],[4637,4645]]],[1568081174558,["sirui-php@DESKTOP-PSVFMK8",[[-1,4637,"language"],[1,4645,"c"]],[4637,4645],[4638,4638]]],[1568081175130,["sirui-php@DESKTOP-PSVFMK8",[[1,4639,"\n"]],[4638,4638],[4639,4639]]],[1568081175409,["sirui-php@DESKTOP-PSVFMK8",[[1,4639,"typedef struct _zend_refcounted_h {\n\tuint32_t         refcount;\t\t\t/* 引用计数 */\n\tunion {\n\t\tstruct {\n\t\t\tZEND_ENDIAN_LOHI_3(\n\t\t\t\tzend_uchar    type,     \n\t\t\t\tzend_uchar    flags,    /* 字符串的类型 */\n\t\t\t\tuint16_t      gc_info   /* 垃圾回收信息 */\n\t\t\t)\n\t\t} v;\n\t\tuint32_t type_info;\n\t} u;\n} zend_refcounted_h;\n————————————————\n版权声明：本文为CSDN博主「关爱程序员社区」的原创文章，遵循 CC 4.0 BY-SA 版权协议，转载请附上原文出处链接及本声明。\n原文链接：https://blog.csdn.net/enoch612/article/details/82806820"]],[4639,4639],[5075,5075]]],[1568081178801,["sirui-php@DESKTOP-PSVFMK8",[[-1,4931,"————————————————\n版权声明：本文为CSDN博主「关爱程序员社区」的原创文章，遵循 CC 4.0 BY-SA 版权协议，转载请附上原文出处链接及本声明。\n原文链接：https://blog.csdn.net/enoch612/article/details/82806820"]],[4931,5075],[4931,4931]]],[1568081179049,["sirui-php@DESKTOP-PSVFMK8",[[-1,4931,"\n"]],[4931,4931],[4930,4930]]],[1568081210674,["sirui-php@DESKTOP-PSVFMK8",[[1,4556,"而"]],[4556,4556],[4557,4557]]],[1568081365852,["sirui-php@DESKTOP-PSVFMK8",[[1,4936,"\n"]],[4935,4935],[4936,4936]]],[1568081366010,["sirui-php@DESKTOP-PSVFMK8",[[1,4937,"\n"]],[4936,4936],[4937,4937]]],[1568081367844,["sirui-php@DESKTOP-PSVFMK8",[[-1,4937,"\n"],[1,4938,"现在"]],[4937,4937],[4939,4939]]],[1568081372595,["sirui-php@DESKTOP-PSVFMK8",[[1,4939,"让我们再来看一个例子："]],[4939,4939],[4950,4950]]],[1568081373148,["sirui-php@DESKTOP-PSVFMK8",[[1,4950,"\n\n"]],[4950,4950],[4951,4951]]],[1568081376826,["sirui-php@DESKTOP-PSVFMK8",[[1,4951,"$var_int_1 = 233; $var_int_2 = &var_int; xdebug_debug_zval('var_int_1');"]],[4951,4951],[5023,5023]]],[1568081377517,["sirui-php@DESKTOP-PSVFMK8",[[-1,4951,"$var_int_1 = 233; $var_int_2 = &var_int; xdebug_debug_zval('var_int_1');"]],[5023,5023],[4951,4951]]],[1568081378572,["sirui-php@DESKTOP-PSVFMK8",[[-1,4951,"\n"],[1,4952,"`"]],[4951,4951],[4952,4952]]],[1568081378929,["sirui-php@DESKTOP-PSVFMK8",[[1,4952,"``"]],[4952,4952],[4954,4954]]],[1568081378972,["sirui-php@DESKTOP-PSVFMK8",[[1,4954,"language\n```\n"]],[4954,4954],[4954,4962]]],[1568081379051,["sirui-php@DESKTOP-PSVFMK8",[[-1,4954,"language"],[1,4962,"p"]],[4954,4962],[4955,4955]]],[1568081379299,["sirui-php@DESKTOP-PSVFMK8",[[1,4955,"hp"]],[4955,4955],[4957,4957]]],[1568081379842,["sirui-php@DESKTOP-PSVFMK8",[[1,4958,"\n"]],[4957,4957],[4958,4958]]],[1568081380011,["sirui-php@DESKTOP-PSVFMK8",[[1,4959,"\n"]],[4958,4958],[4959,4959]]],[1568081380166,["sirui-php@DESKTOP-PSVFMK8",[[1,4959,"$var_int_1 = 233; $var_int_2 = &var_int; xdebug_debug_zval('var_int_1');"]],[4959,4959],[5031,5031]]],[1568081384388,["sirui-php@DESKTOP-PSVFMK8",[[1,4977,"\\"]],[4977,4977],[4978,4978]]],[1568081384853,["sirui-php@DESKTOP-PSVFMK8",[[-1,4976," \\"]],[4978,4978],[4976,4976]]],[1568081385121,["sirui-php@DESKTOP-PSVFMK8",[[1,4976,"\n"]],[4976,4976],[4977,4977]]],[1568081388161,["sirui-php@DESKTOP-PSVFMK8",[[-1,4999," "]],[4999,4999],[4999,4999]]],[1568081388514,["sirui-php@DESKTOP-PSVFMK8",[[1,4999,"\n"]],[4999,4999],[5000,5000]]],[1568081390297,["sirui-php@DESKTOP-PSVFMK8",[[1,5000,"\n"]],[5000,5000],[5001,5001]]],[1568081392513,["sirui-php@DESKTOP-PSVFMK8",[[-1,4958,"\n"]],[4958,4958],[4957,4957]]],[1568081466255,["sirui-php@DESKTOP-PSVFMK8",[[-1,4959,"v"],[-1,4961,"r_int_1"]],[4959,4968],[4960,4960]]],[1568081467739,["sirui-php@DESKTOP-PSVFMK8",[[-1,4969,"var_int_2 "],[1,4979,"b"]],[4969,4979],[4970,4970]]],[1568081468754,["sirui-php@DESKTOP-PSVFMK8",[[-1,4973,"v"],[-1,4975,"r_int"]],[4973,4980],[4974,4974]]],[1568081469626,["sirui-php@DESKTOP-PSVFMK8",[[-1,4996,"v"],[-1,4998,"r_int_1"]],[4996,5005],[4997,4997]]],[1568081474821,["sirui-php@DESKTOP-PSVFMK8",[[1,5005,"\n"]],[5004,5004],[5005,5005]]],[1568081475362,["sirui-php@DESKTOP-PSVFMK8",[[1,5006,"\n"]],[5005,5005],[5006,5006]]],[1568081476588,["sirui-php@DESKTOP-PSVFMK8",[[-1,5006,"\n"],[1,5007,"这段"]],[5006,5006],[5008,5008]]],[1568081488378,["sirui-php@DESKTOP-PSVFMK8",[[1,5008,"代码相对于上面唯一不通电几"]],[5008,5008],[5021,5021]]],[1568081489289,["sirui-php@DESKTOP-PSVFMK8",[[-1,5017,"不通电几"]],[5021,5021],[5017,5017]]],[1568081493843,["sirui-php@DESKTOP-PSVFMK8",[[1,5017,"不同点就是z"]],[5017,5017],[5023,5023]]],[1568081494228,["sirui-php@DESKTOP-PSVFMK8",[[-1,5022,"z"]],[5023,5023],[5022,5022]]],[1568081504246,["sirui-php@DESKTOP-PSVFMK8",[[1,5022,"变量值为整数型，现在"]],[5022,5022],[5032,5032]]],[1568081505289,["sirui-php@DESKTOP-PSVFMK8",[[-1,5030,"现在"]],[5032,5032],[5030,5030]]],[1568081506075,["sirui-php@DESKTOP-PSVFMK8",[[1,5030,"现在"]],[5030,5030],[5032,5032]]],[1568081506464,["sirui-php@DESKTOP-PSVFMK8",[[-1,5030,"现在"]],[5032,5032],[5030,5030]]],[1568081525092,["sirui-php@DESKTOP-PSVFMK8",[[1,5030,"我们根据上面第二点可以得出 "]],[5030,5030],[5044,5044]]],[1568081525480,["sirui-php@DESKTOP-PSVFMK8",[[-1,5043," "]],[5044,5044],[5043,5043]]],[1568081526468,["sirui-php@DESKTOP-PSVFMK8",[[1,5043,"，若果"]],[5043,5043],[5046,5046]]],[1568081526837,["sirui-php@DESKTOP-PSVFMK8",[[-1,5044,"若果"]],[5046,5046],[5044,5044]]],[1568081528773,["sirui-php@DESKTOP-PSVFMK8",[[1,5044,"当值为"]],[5044,5044],[5047,5047]]],[1568081539604,["sirui-php@DESKTOP-PSVFMK8",[[1,5047,"简单数据类型"]],[5047,5047],[5053,5053]]],[1568081540745,["sirui-php@DESKTOP-PSVFMK8",[[-1,5045,"值"]],[5046,5046],[5045,5045]]],[1568081541902,["sirui-php@DESKTOP-PSVFMK8",[[1,5045,"Value"]],[5045,5045],[5050,5050]]],[1568081545104,["sirui-php@DESKTOP-PSVFMK8",[[1,5057,"时其"]],[5057,5057],[5059,5059]]],[1568081557625,["sirui-php@DESKTOP-PSVFMK8",[[-1,5058,"其"]],[5059,5059],[5058,5058]]],[1568081560858,["sirui-php@DESKTOP-PSVFMK8",[[1,5058," 能够直接储存具体的值"]],[5058,5058],[5069,5069]]],[1568081567028,["sirui-php@DESKTOP-PSVFMK8",[[1,5045,"``"]],[5045,5045],[5047,5047]]],[1568081568824,["sirui-php@DESKTOP-PSVFMK8",[[-1,5047,"Value"]],[5047,5052],[5047,5047]]],[1568081570130,["sirui-php@DESKTOP-PSVFMK8",[[1,5046,"Value"]],[5046,5046],[5051,5051]]],[1568081577988,["sirui-php@DESKTOP-PSVFMK8",[[1,5061,"zval_struct.value`"]],[5061,5061],[5079,5079]]],[1568081581187,["sirui-php@DESKTOP-PSVFMK8",[[1,5061,"`"]],[5061,5061],[5062,5062]]],[1568081586406,["sirui-php@DESKTOP-PSVFMK8",[[1,5090," 其中整形"]],[5090,5090],[5095,5095]]],[1568081586732,["sirui-php@DESKTOP-PSVFMK8",[[-1,5094,"形"]],[5095,5095],[5094,5094]]],[1568081591028,["sirui-php@DESKTOP-PSVFMK8",[[1,5094,"型就属于"]],[5094,5094],[5098,5098]]],[1568081593260,["sirui-php@DESKTOP-PSVFMK8",[[1,5098,"煎蛋"]],[5098,5098],[5100,5100]]],[1568081593697,["sirui-php@DESKTOP-PSVFMK8",[[-1,5098,"煎蛋"]],[5100,5100],[5098,5098]]],[1568081603320,["sirui-php@DESKTOP-PSVFMK8",[[1,5098,"简单数据类型，那么跟"]],[5098,5098],[5108,5108]]],[1568081604148,["sirui-php@DESKTOP-PSVFMK8",[[-1,5105,"那么跟"]],[5108,5108],[5105,5105]]],[1568081607496,["sirui-php@DESKTOP-PSVFMK8",[[1,5105,"所以"]],[5105,5105],[5107,5107]]],[1568081608267,["sirui-php@DESKTOP-PSVFMK8",[[-1,5105,"所以"]],[5107,5107],[5105,5105]]],[1568081622452,["sirui-php@DESKTOP-PSVFMK8",[[1,5090,"，就不会在对他们进行引用计数，"]],[5090,5090],[5105,5105]]],[1568081631558,["sirui-php@DESKTOP-PSVFMK8",[[1,5120,"那么我们猜测的结果应该是："]],[5120,5120],[5133,5133]]],[1568081631802,["sirui-php@DESKTOP-PSVFMK8",[[1,5133,"\n\n"]],[5133,5133],[5134,5134]]],[1568081641782,["sirui-php@DESKTOP-PSVFMK8",[[-1,5134,"\n"],[1,5135,"`"]],[5134,5134],[5135,5135]]],[1568081642145,["sirui-php@DESKTOP-PSVFMK8",[[1,5135,"``"]],[5135,5135],[5137,5137]]],[1568081642190,["sirui-php@DESKTOP-PSVFMK8",[[1,5137,"language\n```\n"]],[5137,5137],[5137,5145]]],[1568081643065,["sirui-php@DESKTOP-PSVFMK8",[[-1,5137,"language"]],[5137,5145],[5137,5137]]],[1568081644139,["sirui-php@DESKTOP-PSVFMK8",[[1,5137,"php"]],[5137,5137],[5140,5140]]],[1568081644514,["sirui-php@DESKTOP-PSVFMK8",[[1,5141,"\n"]],[5140,5140],[5141,5141]]],[1568081648701,["sirui-php@DESKTOP-PSVFMK8",[[1,5141,"//猜测结果："]],[5141,5141],[5148,5148]]],[1568081649362,["sirui-php@DESKTOP-PSVFMK8",[[-1,5147,"："]],[5148,5148],[5147,5147]]],[1568081649586,["sirui-php@DESKTOP-PSVFMK8",[[1,5148,"\n"]],[5147,5147],[5148,5148]]],[1568081684338,["sirui-php@DESKTOP-PSVFMK8",[[1,5148,"a: (refcount=2, is_ref=1)=123\nb: (refcount=2, is_ref=1)=123"]],[5148,5148],[5207,5207]]],[1568081687524,["sirui-php@DESKTOP-PSVFMK8",[[-1,5161,"2"]],[5162,5162],[5161,5161]]],[1568081687950,["sirui-php@DESKTOP-PSVFMK8",[[1,5161,"0"]],[5161,5161],[5162,5162]]],[1568081688856,["sirui-php@DESKTOP-PSVFMK8",[[-1,5191,"2"]],[5192,5192],[5191,5191]]],[1568081689364,["sirui-php@DESKTOP-PSVFMK8",[[1,5191,"0"]],[5191,5191],[5192,5192]]],[1568081747941,["sirui-php@DESKTOP-PSVFMK8",[[1,5120,"而按值拷贝时，会开辟一个新的 `zval_struct` 以同样的方式将值储存到相同数据类型的 value 中，所以 refcount 的值一直都会为 0。"]],[5120,5120],[5198,5198]]],[1568081748638,["sirui-php@DESKTOP-PSVFMK8",[[-1,5120,"而按值拷贝时，会开辟一个新的 `zval_struct` 以同样的方式将值储存到相同数据类型的 value 中，所以 refcount 的值一直都会为 0。"]],[5198,5198],[5120,5120]]],[1568081749307,["sirui-php@DESKTOP-PSVFMK8",[[1,5120,"而按值拷贝时，会开辟一个新的 `zval_struct` 以同样的方式将值储存到相同数据类型的 value 中，所以 refcount 的值一直都会为 0。"]],[5120,5120],[5198,5198]]],[1568081751787,["sirui-php@DESKTOP-PSVFMK8",[[-1,5120,"而按值拷贝时，会开辟一个新的 `zval_struct` 以同样的方式将值储存到相同数据类型的 value 中，所以 refcount 的值一直都会为 0。"]],[5198,5198],[5120,5120]]],[1568081756002,["sirui-php@DESKTOP-PSVFMK8",[[1,5091,"而按值拷贝时，会开辟一个新的 `zval_struct` 以同样的方式将值储存到相同数据类型的 value 中，所以 refcount 的值一直都会为 0。"]],[5091,5091],[5169,5169]]],[1568081757260,["sirui-php@DESKTOP-PSVFMK8",[[1,5169,"\n"]],[5169,5169],[5170,5170]]],[1568081758427,["sirui-php@DESKTOP-PSVFMK8",[[-1,5169,"\n"]],[5170,5170],[5169,5169]]],[1568081759379,["sirui-php@DESKTOP-PSVFMK8",[[1,5169,"\n"]],[5169,5169],[5170,5170]]],[1568081766266,["sirui-php@DESKTOP-PSVFMK8",[[-1,5170,"就不会在对他们进行引用计数，"]],[5170,5184],[5170,5170]]],[1568081766722,["sirui-php@DESKTOP-PSVFMK8",[[-1,5169,"\n"]],[5170,5170],[5169,5169]]],[1568081770922,["sirui-php@DESKTOP-PSVFMK8",[[1,5276,"\n"]],[5275,5275],[5276,5276]]],[1568081771289,["sirui-php@DESKTOP-PSVFMK8",[[1,5277,"\n"]],[5276,5276],[5277,5277]]],[1568081779081,["sirui-php@DESKTOP-PSVFMK8",[[-1,5105," "],[1,5106," "],[-1,5119," "],[1,5120," "],[-1,5277,"\n"],[1,5278,"然后"]],[5277,5277],[5279,5279]]],[1568081782838,["sirui-php@DESKTOP-PSVFMK8",[[1,5279,"实际结果是"]],[5279,5279],[5284,5284]]],[1568081783417,["sirui-php@DESKTOP-PSVFMK8",[[-1,5283,"是"]],[5284,5284],[5283,5283]]],[1568081783940,["sirui-php@DESKTOP-PSVFMK8",[[1,5283,"："]],[5283,5283],[5284,5284]]],[1568081784107,["sirui-php@DESKTOP-PSVFMK8",[[1,5284,"\n\n"]],[5284,5284],[5285,5285]]],[1568081787548,["sirui-php@DESKTOP-PSVFMK8",[[-1,5285,"\n"],[1,5286,"·"]],[5285,5285],[5286,5286]]],[1568081787940,["sirui-php@DESKTOP-PSVFMK8",[[1,5286,"·"]],[5286,5286],[5287,5287]]],[1568081788262,["sirui-php@DESKTOP-PSVFMK8",[[-1,5286,"·"]],[5287,5287],[5286,5286]]],[1568081788401,["sirui-php@DESKTOP-PSVFMK8",[[-1,5285,"·"],[1,5286,"\n"]],[5286,5286],[5285,5285]]],[1568081788812,["sirui-php@DESKTOP-PSVFMK8",[[-1,5285,"\n"],[1,5286,"`"]],[5285,5285],[5286,5286]]],[1568081789372,["sirui-php@DESKTOP-PSVFMK8",[[1,5286,"``"]],[5286,5286],[5288,5288]]],[1568081789408,["sirui-php@DESKTOP-PSVFMK8",[[1,5288,"language\n```\n"]],[5288,5288],[5288,5296]]],[1568081789729,["sirui-php@DESKTOP-PSVFMK8",[[-1,5288,"language"]],[5288,5296],[5288,5288]]],[1568081790580,["sirui-php@DESKTOP-PSVFMK8",[[1,5288,"php"]],[5288,5288],[5291,5291]]],[1568081790787,["sirui-php@DESKTOP-PSVFMK8",[[1,5292,"\n"]],[5291,5291],[5292,5292]]],[1568081790945,["sirui-php@DESKTOP-PSVFMK8",[[1,5292,"```php\n//猜测结果\na: (refcount=0, is_ref=1)=123\nb: (refcount=0, is_ref=1)=123\n```"]],[5292,5292],[5369,5369]]],[1568081796932,["sirui-php@DESKTOP-PSVFMK8",[[-1,5301,"猜测"],[1,5303,"实际"]],[5301,5305],[5305,5305]]],[1568081798523,["sirui-php@DESKTOP-PSVFMK8",[[-1,5292,"```php"]],[5298,5298],[5292,5292]]],[1568081798698,["sirui-php@DESKTOP-PSVFMK8",[[-1,5292,"\n"]],[5292,5292],[5291,5291]]],[1568081800574,["sirui-php@DESKTOP-PSVFMK8",[[-1,5312,"0"],[1,5313,"2"]],[5312,5313],[5313,5313]]],[1568081801444,["sirui-php@DESKTOP-PSVFMK8",[[-1,5342,"0"],[1,5343,"2"]],[5342,5343],[5343,5343]]],[1568081804618,["sirui-php@DESKTOP-PSVFMK8",[[1,5367,"\n"]],[5366,5366],[5367,5367]]],[1568081813510,["sirui-php@DESKTOP-PSVFMK8",[[-1,5367,"\n"],[1,5368,"z"]],[5367,5367],[5368,5368]]],[1568081813828,["sirui-php@DESKTOP-PSVFMK8",[[1,5368,"he"]],[5368,5368],[5370,5370]]],[1568081814196,["sirui-php@DESKTOP-PSVFMK8",[[-1,5368,"he"]],[5370,5370],[5368,5368]]],[1568081814346,["sirui-php@DESKTOP-PSVFMK8",[[-1,5367,"z"],[1,5368,"\n"]],[5368,5368],[5367,5367]]],[1568081814607,["sirui-php@DESKTOP-PSVFMK8",[[-1,5367,"\n"],[1,5368,"z"]],[5367,5367],[5368,5368]]],[1568081814812,["sirui-php@DESKTOP-PSVFMK8",[[1,5368,"he"]],[5368,5368],[5370,5370]]],[1568081815361,["sirui-php@DESKTOP-PSVFMK8",[[-1,5368,"he"]],[5370,5370],[5368,5368]]],[1568081815508,["sirui-php@DESKTOP-PSVFMK8",[[-1,5367,"z"],[1,5368,"\n"]],[5368,5368],[5367,5367]]],[1568081816510,["sirui-php@DESKTOP-PSVFMK8",[[-1,5367,"\n"],[1,5368,"这是"]],[5367,5367],[5369,5369]]],[1568081819652,["sirui-php@DESKTOP-PSVFMK8",[[1,5369,"因为但是当使用 `&` 操作符进行引用拷贝时，情况就不一样了："]],[5369,5369],[5400,5400]]],[1568081821378,["sirui-php@DESKTOP-PSVFMK8",[[-1,5371,"但是"]],[5373,5373],[5371,5371]]],[1568081827994,["sirui-php@DESKTOP-PSVFMK8",[[1,5398,"\n\n"]],[5398,5398],[5399,5399]]],[1568081828229,["sirui-php@DESKTOP-PSVFMK8",[[1,5399,"1.  PHP 为 `&` 操作符操作的变量申请一个 `zend_reference` 结构\n2.  将 `zend_reference.value` 指向原来的 `zval_struct.value`\n3.  `zval_struct.value` 的数据类型会被修改为 `zend_refrence`\n4.  将 `zval_struct.value` 指向刚刚申请并初始化后的 `zend_reference`\n5.  为新变量申请 `zval_struct` 结构，将他的 `value` 指向刚刚创建的 `zend_reference`\n\n此时：$var_int_1 和 $var_int_2 都拥有一个 `zval_struct` 结构体，并且他们的 `zval_struct.value` 都指向了同一个 `zend_reference` 结构，所以该结构的引用计数器的值为 2。\n\n作者：Gtaker\n链接：https://juejin.im/post/5bbf50e86fb9a05ce02a9c19\n来源：掘金\n著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"]],[5399,5399],[5899,5899]]],[1568081831434,["sirui-php@DESKTOP-PSVFMK8",[[1,5399,"\n"]],[5398,5398],[5399,5399]]],[1568081833030,["sirui-php@DESKTOP-PSVFMK8",[[-1,5399,"\n"]],[5399,5399],[5398,5398]]],[1568081834985,["sirui-php@DESKTOP-PSVFMK8",[[-1,5366,"\n"]],[5366,5366],[5366,5366]]],[1568081835848,["sirui-php@DESKTOP-PSVFMK8",[[1,5366,"\n"]],[5366,5366],[5366,5366]]],[1568081836513,["sirui-php@DESKTOP-PSVFMK8",[[-1,5363,"```"]],[5366,5366],[5363,5363]]],[1568081840473,["sirui-php@DESKTOP-PSVFMK8",[[-1,5795,"作者：Gtaker\n链接：https://juejin.im/post/5bbf50e86fb9a05ce02a9c19\n来源：掘金\n著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。\n"]],[5794,5896],[5794,5794]]],[1568081840889,["sirui-php@DESKTOP-PSVFMK8",[[-1,5794,"\n"]],[5794,5794],[5793,5793]]],[1568082003091,["sirui-php@DESKTOP-PSVFMK8",[[1,2996,"\n"]],[2994,2994],[2995,2995]]],[1568082003282,["sirui-php@DESKTOP-PSVFMK8",[[1,2997,"\n"]],[2995,2995],[2996,2996]]],[1568082003444,["sirui-php@DESKTOP-PSVFMK8",[[1,2996,"#"],[-1,5373," `&` "],[1,5378," `&` "]],[2996,2996],[2997,2997]]],[1568082004172,["sirui-php@DESKTOP-PSVFMK8",[[1,2997,"# "]],[2997,2997],[2999,2999]]],[1568082006857,["sirui-php@DESKTOP-PSVFMK8",[[-1,2997,"# "]],[2999,2999],[2997,2997]]],[1568082007113,["sirui-php@DESKTOP-PSVFMK8",[[-1,2996,"#"],[1,5374," `&` "],[-1,5374," `&` "]],[2997,2997],[2996,2996]]],[1568082007352,["sirui-php@DESKTOP-PSVFMK8",[[-1,2997,"\n"]],[2996,2996],[2995,2995]]],[1568082007783,["sirui-php@DESKTOP-PSVFMK8",[[-1,2996,"\n"]],[2995,2995],[2994,2994]]],[1568082020482,["sirui-php@DESKTOP-PSVFMK8",[[1,5794,"\n"]],[5793,5793],[5794,5794]]],[1568082020822,["sirui-php@DESKTOP-PSVFMK8",[[1,5795,"\n"]],[5794,5794],[5795,5795]]],[1568082021173,["sirui-php@DESKTOP-PSVFMK8",[[-1,5371," `&` "],[1,5376," `&` "],[-1,5795,"\n"],[1,5796,"#"]],[5795,5795],[5796,5796]]],[1568082024350,["sirui-php@DESKTOP-PSVFMK8",[[1,5796,"# 引用文章"]],[5796,5796],[5802,5802]]],[1568082025290,["sirui-php@DESKTOP-PSVFMK8",[[1,5802,"\n\n"]],[5802,5802],[5803,5803]]],[1568082045212,["sirui-php@DESKTOP-PSVFMK8",[[1,5795,"\n"]],[5794,5794],[5795,5795]]],[1568082045363,["sirui-php@DESKTOP-PSVFMK8",[[1,5795,"## 总结\n\n*   简单数据类型\n    *   整形（不使用引用计数）\n    *   浮点型（不使用引用计数）\n    *   布尔型（不使用引用计数）\n    *   NULL（不使用引用计数）\n*   复杂数据类型\n    *   字符串\n        *   普通字符串（使用引用计数，初始值为 1）\n        *   内部字符串（不使用引用计数，引用计数值恒为 0）\n    *   数组\n        *   普通数组（使用引用计数，初始值为 1）\n        *   不可变数组（不使用引用计数，使用伪计数值 2）\n    *   对象（使用引用计数，初始值为 1）\n\n作者：Gtaker\n链接：https://juejin.im/post/5bbf50e86fb9a05ce02a9c19\n来源：掘金\n著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"]],[5795,5795],[6197,6197]]],[1568082049462,["sirui-php@DESKTOP-PSVFMK8",[[-1,6096,"作者：Gtaker\n链接：https://juejin.im/post/5bbf50e86fb9a05ce02a9c19\n来源：掘金\n著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"]],[6096,6197],[6096,6096]]],[1568082049722,["sirui-php@DESKTOP-PSVFMK8",[[-1,6096,"\n"]],[6096,6096],[6095,6095]]],[1568082070507,["sirui-php@DESKTOP-PSVFMK8",[[-1,5795,"## 总结\n\n*   简单数据类型\n    *   整形（不使用引用计数）\n    *   浮点型（不使用引用计数）\n    *   布尔型（不使用引用计数）\n    *   NULL（不使用引用计数）\n*   复杂数据类型\n    *   字符串\n        *   普通字符串（使用引用计数，初始值为 1）\n        *   内部字符串（不使用引用计数，引用计数值恒为 0）\n    *   数组\n        *   普通数组（使用引用计数，初始值为 1）\n        *   不可变数组（不使用引用计数，使用伪计数值 2）\n    *   对象（使用引用计数，初始值为 1）"]],[5795,6094],[5795,5795]]],[1568082070716,["sirui-php@DESKTOP-PSVFMK8",[[-1,5796,"\n"]],[5795,5795],[5794,5794]]],[1568082085482,["sirui-php@DESKTOP-PSVFMK8",[[1,5805,"\n"]],[5803,5803],[5804,5804]]],[1568082088939,["sirui-php@DESKTOP-PSVFMK8",[[1,5804,"[https://juejin.im/post/5bbf50e86fb9a05ce02a9c19](https://juejin.im/post/5bbf50e86fb9a05ce02a9c19)"]],[5804,5804],[5902,5902]]],[1568082097330,["sirui-php@DESKTOP-PSVFMK8",[[-1,5804,"[https://juejin.im/post/5bbf50e86fb9a05ce02a9c19"]],[5804,5852],[5804,5804]]],[1568082098328,["sirui-php@DESKTOP-PSVFMK8",[[1,5804,"【"]],[5804,5804],[5805,5805]]],[1568082099210,["sirui-php@DESKTOP-PSVFMK8",[[-1,5804,"【"]],[5805,5805],[5804,5804]]],[1568082099934,["sirui-php@DESKTOP-PSVFMK8",[[1,5804,"[# 深入理解 PHP7 中全新的 zval 容器和引用计数机制"]],[5804,5804],[5836,5836]]],[1568082102402,["sirui-php@DESKTOP-PSVFMK8",[[-1,5805,"# "]],[5807,5807],[5805,5805]]],[1568082107684,["sirui-php@DESKTOP-PSVFMK8",[[1,5804,"1. "]],[5804,5804],[5807,5807]]],[1568082109675,["sirui-php@DESKTOP-PSVFMK8",[[1,5888,"2. \n"]],[5887,5887],[5891,5891]]],[1568082131595,["sirui-php@DESKTOP-PSVFMK8",[[1,5891,"[]"]],[5891,5891],[5893,5893]]],[1568082132547,["sirui-php@DESKTOP-PSVFMK8",[[-1,5891,"[]"]],[5893,5893],[5891,5891]]],[1568082133036,["sirui-php@DESKTOP-PSVFMK8",[[1,5891,"[https://github.com/laruence/php7-internal/blob/master/zval.md](https://github.com/laruence/php7-internal/blob/master/zval.md)"]],[5891,5891],[6017,6017]]],[1568082139395,["sirui-php@DESKTOP-PSVFMK8",[[-1,5892,"https://github.com/laruence/php7-internal/blob/master/"],[1,5946,"### 深入理解PHP7之"],[-1,5950,".md"]],[5892,5953],[5909,5909]]],[1568082142058,["sirui-php@DESKTOP-PSVFMK8",[[-1,5892,"### "]],[5896,5896],[5892,5892]]],[1568082143626,["sirui-php@DESKTOP-PSVFMK8",[[1,5970,"3. \n"]],[5969,5969],[5973,5973]]],[1568082150346,["sirui-php@DESKTOP-PSVFMK8",[[1,5973,"[https://stackoverflow.com/questions/34764119/confusion-about-php-7-refcount](https://stackoverflow.com/questions/34764119/confusion-about-php-7-refcount)"]],[5973,5973],[6127,6127]]],[1568082157556,["sirui-php@DESKTOP-PSVFMK8",[[1,5974,"# [Confusion about PHP 7 refcount]("],[1,6049,")"]],[5974,6049],[6085,6085]]],[1568082158917,["sirui-php@DESKTOP-PSVFMK8",[[-1,5974,"# [Confusion about PHP 7 refcount]("],[-1,6084,")"]],[6085,6085],[5974,6049]]],[1568082169219,["sirui-php@DESKTOP-PSVFMK8",[[-1,5974,"https://stackoverflow.com/questions/34764119/"]],[5974,6049],[6004,6004]]],[1568082173066,["sirui-php@DESKTOP-PSVFMK8",[[-1,5995,"-"]],[5996,5996],[5995,5995]]],[1568082173333,["sirui-php@DESKTOP-PSVFMK8",[[1,5995," "]],[5995,5995],[5996,5996]]],[1568082174747,["sirui-php@DESKTOP-PSVFMK8",[[-1,5989,"-"]],[5990,5990],[5989,5989]]],[1568082174884,["sirui-php@DESKTOP-PSVFMK8",[[1,5989," "]],[5989,5989],[5990,5990]]],[1568082176655,["sirui-php@DESKTOP-PSVFMK8",[[-1,5983,"-"]],[5984,5984],[5983,5983]]],[1568082176796,["sirui-php@DESKTOP-PSVFMK8",[[1,5983," "]],[5983,5983],[5984,5984]]],[1568082219572,["sirui-php@DESKTOP-PSVFMK8",[[1,6083,"4. \n"]],[6082,6082],[6086,6086]]],[1568082220589,["sirui-php@DESKTOP-PSVFMK8",[[1,6086,"[https://www.jianshu.com/p/53fcf6128dcd](https://www.jianshu.com/p/53fcf6128dcd)"]],[6086,6086],[6166,6166]]],[1568082225810,["sirui-php@DESKTOP-PSVFMK8",[[-1,6087,"https://www.jianshu.com/p/53fcf6128dcd"],[1,6125,"# PHP引用变量机制(PHP如何处理变量)"]],[6087,6125],[6109,6109]]],[1568082236557,["sirui-php@DESKTOP-PSVFMK8",[[1,6151,"5. \n"]],[6150,6150],[6154,6154]]],[1568082239578,["sirui-php@DESKTOP-PSVFMK8",[[-1,6087,"# "]],[6089,6089],[6087,6087]]],[1568082240722,["sirui-php@DESKTOP-PSVFMK8",[[1,6152,"[https://blog.csdn.net/enoch612/article/details/82806820](https://blog.csdn.net/enoch612/article/details/82806820)"]],[6152,6152],[6266,6266]]],[1568082246056,["sirui-php@DESKTOP-PSVFMK8",[[-1,6153,"https://blog.csdn.net/enoch612/article/details/82806820"],[1,6208,"# 跟厂长学PHP7内核（八）：深入理解字符串的实现"]],[6153,6208],[6179,6179]]],[1568082248578,["sirui-php@DESKTOP-PSVFMK8",[[-1,6153,"# "]],[6155,6155],[6153,6153]]],[1568082263509,["sirui-php@DESKTOP-PSVFMK8",[[1,6236,"6. \n"]],[6235,6235],[6239,6239]]],[1568082264139,["sirui-php@DESKTOP-PSVFMK8",[[1,6239,"[http://docs.php.net/manual/zh/features.gc.refcounting-basics.php](http://docs.php.net/manual/zh/features.gc.refcounting-basics.php)"]],[6239,6239],[6371,6371]]],[1568082269171,["sirui-php@DESKTOP-PSVFMK8",[[-1,6240,"http://docs.php.net/manual/zh/features.gc.refcounting-basics.php"],[1,6304,"## 引用计数基本知识"]],[6240,6304],[6251,6251]]],[1568082272074,["sirui-php@DESKTOP-PSVFMK8",[[-1,6240,"## "]],[6243,6243],[6240,6240]]]],null,"sirui-php@DESKTOP-PSVFMK8"],["e185598a-89d9-4149-bb89-3cbc7ffe4752",1568082425800,"## 前言\n在学习PHP垃圾回收机制之前先让我们来学习下 `引用计数` 的基本知识，学习 `引用计数` 有助于我们了解垃圾回收机制的原理以及php底层，因为PHP垃圾回收机制就是基于`引用计数`的，在介绍引用计数之前，我曾翻阅过PHP的官方手册，在测试代码的时候发现运行结果与官方手册所写的不符，翻阅相关资料之后发现是官方手册还停留在PH5.x的版本上，而我本地的环境是PHP7.3,所以导致代码结果与官方手册不符，关于为什么不符合，在下文会详细说明，并且会说明引用计数在PHP5.x版本与PHP7.x版本的差异性，当然主要侧重于解释新zval容器中的引用计数机制。\n\n\n## 引用计数基本知识\n\n首先我们先来了解一下 `引用计数`，引用官方文档的一段话： 每个php变量存在一个叫\"zval\"的变量容器中。容器除了包含变量的类型和值，还包括两个字节的额外信息。第一个是\"is_ref\"，是个bool值，用来标识这个变量是否是属于引用集合(reference set)。通过这个字节，php引擎才能把普通变量和引用变量区分开来，由于php允许用户通过使用&来使用自定义引用，zval变量容器中还有一个内部引用计数机制，来优化内存使用。第二个额外字节是\"refcount\"，用以表示指向这个zval变量容器的变量(也称符号即symbol)个数，这是PHP官方手册的一个讲解，而这个手册只适用于PHP5.x版本，我们用代码来演示一下\n\n```php\n$a = 'new string';\n\nxdebug_debug_zval('a');\n\n//打印结果：\n\na: (refcount=1, is_ref=0)='new string'\n```\n\n注意：你需要安装xdebug拓展才可以执行以上代码，使用debug_zval_dump也可以打印出，但是debug_zval_dump打印的结果与xdebug_debug_zval 打印的结果存在差异，具体说明在本文章中不作解释，具体可查看：[PHP xdebug_debug_zval debug_zval_dump 使用](https://blog.csdn.net/pzqingchong/article/details/78004840)\n\n从结果得知，refcount = 1代表有一个变量名指向这个zval容器 is_ref = 0 代表没有存在引用传递，下面我们增加代码，并且分别使用PHP5.6的环境与PHP7.3的环境执行\n\n```php\n$a = 'new string';\n\n$b = $a;\n\nxdebug_debug_zval('a');\n\n//PHP5.6执行结果：\na: (refcount=2, is_ref=0)='new string'\n\n//PHP7.3执行结果：\na: (refcount=1, is_ref=0)='new string'\n```\n\n从结果发现，PHP5.6的refcount发生了变化，数值增加了1，而PHP7.3的结果却没发生过变化，当我们增加变量引用时同样也不会发生变化，在查阅有关资料后发现，原来是zval容器结构更新了，\n\n## Zval容器\n\nPHP5.x版本的Zval容器：\n\n```c\nstruct _zval_struct {\n\tunion {\n\t\tlong lval;\n\t\tdouble dval;\n\t\tstruct {\n\t\t\tchar *val;\n\t\t\tint len;\n\t\t} str;\n\t\tHashTable *ht;\n\t\tzend_object_value obj;\n\t\tzend_ast *ast;\n\t} value;\n\tzend_uint refcount__gc;\n\tzend_uchar type;\n\tzend_uchar is_ref__gc;\n};\n```\n\nPHP7.x版本的Zval容器：\n```c\nstruct _zval_struct {\n\tunion {\n\t\tzend_long         lval;             /* long value */\n\t\tdouble            dval;             /* double value */\n\t\tzend_refcounted  *counted;\n\t\tzend_string      *str;\n\t\tzend_array       *arr;\n\t\tzend_object      *obj;\n\t\tzend_resource    *res;\n\t\tzend_reference   *ref;\n\t\tzend_ast_ref     *ast;\n\t\tzval             *zv;\n\t\tvoid             *ptr;\n\t\tzend_class_entry *ce;\n\t\tzend_function    *func;\n\t\tstruct {\n\t\t\tuint32_t w1;\n\t\t\tuint32_t w2;\n\t\t} ww;\n\t} value;\n    union {\n        struct {\n            ZEND_ENDIAN_LOHI_4(\n                zend_uchar    type,         /* active type */\n                zend_uchar    type_flags,\n                zend_uchar    const_flags,\n                zend_uchar    reserved)     /* call info for EX(This) */\n        } v;\n        uint32_t type_info;\n    } u1;\n    union {\n        uint32_t     var_flags;\n        uint32_t     next;                 /* hash collision chain */\n        uint32_t     cache_slot;           /* literal cache slot */\n        uint32_t     lineno;               /* line number (for ast nodes) */\n        uint32_t     num_args;             /* arguments number for EX(This) */\n        uint32_t     fe_pos;               /* foreach position */\n        uint32_t     fe_iter_idx;          /* foreach iterator index */\n    } u2;\n};\n```\n\n一个全新的容器结构，对于该结构的详细描述可以参考鸟哥的文章，链接在`引用文章`中会放出来，对比PHP5.x，有几个重要的更新点：\n\n1.  PHP7 中的变量分为**变量名**和**变量值**两部分，分别对应 `zval_struct` 和在其中声明的 `value`*  \n \n说明：这点并不难理解，每个新建的变量都有与其相对应的zval_struct容器，而变量值则存储于容器中的value\n\n![](http://images.linyiyuan.top/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20190910092340.png)\n\n2. `zval_struct.value` 中的 `zend_long` 、`double` 都是**简单数据类型**，能够直接储存具体的值，而其他复杂数据类型储存一个指向其他数据结构的**指针**\n\n说明:  `zend_long` 、`double`  即我们在 PHP 中的**整形**与**浮点型**, 对于 `zval` 在 `value` 字段中能保存下的值，就不会在对他们进行引用计数，**而是在拷贝的时候直接赋值**\n\n3. PHP7 中，引用计数器储存在 `value` 中而不是 `zval_struct`\n4. **NULL**、**布尔型**都属于**没有值**的数据类型（其中布尔型通过 `IS_FALSE` 和 `IS_TRUE` 两个常量来标记），自然也就没有引用计数\n5. **引用**（REFERENCE）变为了一种数据结构而不再只是一个标记位了，它的结构如下：\n\n```c\nstruct _zend_reference {\n    zend_refcounted_h gc;\n    zval              val;\n}\n```\n6. `zend_reference` 作为 `zval_struct` 中包含的一种 `value` 类型，也拥有自己的 `val` 值，这个值是指向一个 `zval_struct.value` 的。他们都拥有自己的**引用计数器**。\n\n    引用计数器用来记录当前有多少 `zval` 指向同一个 `zend_value`。\n\n以上六点就是对zval容器的更新总结，而针对第六点，我们使用代码进行讲解：请看如下代码：\n\n```php\n$a = 'foo'; \n\n$b = &$a;\n\n$c = $a;\n\nxdebug_debug_zval('a');\nxdebug_debug_zval('b');\nxdebug_debug_zval('c');\n```\n\n$a 与 $b 各拥有一个 `zval_struct` 容器，并且其中的 `value` 都指向同一个 `zend_reference` 结构，`zend_reference` 内嵌一个 `val` 结构， 指向同一个 `zend_string`，**字符串的内容**就储存在其中。\n\n而 $c 也拥有一个 `zval_struct`，而它的 value 在初始化的时候可以直接指向上面提到的 `zend_string` ，这样在拷贝时就不会产生复制。\n![](http://images.linyiyuan.top/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20190910094943.png)\n\n然后我们运行代码：\n![](http://images.linyiyuan.top/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20190910095938.png)\n\n从图中不难发现，$a跟$b 的`refcount` 为2，$c为1，我们根据第五点以及第六点可以知道 $a跟$b都指向同一个 `zend_reference` 所以他们的refcount为2  而`zend_reference` 的结构包含gc 其gc 就是` _zend_refcounted_h `的结构体 主要作用是引用计数以及标记变量的类别\n\n```c\ntypedef struct _zend_refcounted_h {\n\tuint32_t         refcount;\t\t\t/* 引用计数 */\n\tunion {\n\t\tstruct {\n\t\t\tZEND_ENDIAN_LOHI_3(\n\t\t\t\tzend_uchar    type,     \n\t\t\t\tzend_uchar    flags,    /* 字符串的类型 */\n\t\t\t\tuint16_t      gc_info   /* 垃圾回收信息 */\n\t\t\t)\n\t\t} v;\n\t\tuint32_t type_info;\n\t} u;\n} zend_refcounted_h;\n```\n\n现在让我们再来看一个例子：\n```php\n$a = 233;\n$b= &a;\n\nxdebug_debug_zval('a');\n```\n\n这段代码相对于上面唯一不同点就是变量值为整数型，我们根据上面第二点可以得出，当`Value`为简单数据类型时 `zval_struct.value`能够直接储存具体的值，而按值拷贝时，会开辟一个新的 `zval_struct` 以同样的方式将值储存到相同数据类型的 value 中，所以 refcount 的值一直都会为 0。 其中整型就属于简单数据类型，那么我们猜测的结果应该是：\n```php\n//猜测结果\na: (refcount=0, is_ref=1)=123\nb: (refcount=0, is_ref=1)=123\n```\n\n然后实际结果：\n```php\n//实际结果\na: (refcount=2, is_ref=1)=123\nb: (refcount=2, is_ref=1)=123\n```\n\n这是因为当使用 `&` 操作符进行引用拷贝时，情况就不一样了：\n1.  PHP 为 `&` 操作符操作的变量申请一个 `zend_reference` 结构\n2.  将 `zend_reference.value` 指向原来的 `zval_struct.value`\n3.  `zval_struct.value` 的数据类型会被修改为 `zend_refrence`\n4.  将 `zval_struct.value` 指向刚刚申请并初始化后的 `zend_reference`\n5.  为新变量申请 `zval_struct` 结构，将他的 `value` 指向刚刚创建的 `zend_reference`\n\n此时：$var_int_1 和 $var_int_2 都拥有一个 `zval_struct` 结构体，并且他们的 `zval_struct.value` 都指向了同一个 `zend_reference` 结构，所以该结构的引用计数器的值为 2。\n\n\n## 引用文章\n1. [深入理解 PHP7 中全新的 zval 容器和引用计数机制](https://juejin.im/post/5bbf50e86fb9a05ce02a9c19)\n2. [深入理解PHP7之zval](https://github.com/laruence/php7-internal/blob/master/zval.md)\n3. [confusion about php-7 refcount](https://stackoverflow.com/questions/34764119/confusion-about-php-7-refcount)\n4. [PHP引用变量机制(PHP如何处理变量)](https://www.jianshu.com/p/53fcf6128dcd)\n5. [跟厂长学PHP7内核（八）：深入理解字符串的实现](https://blog.csdn.net/enoch612/article/details/82806820)\n6. [引用计数基本知识](http://docs.php.net/manual/zh/features.gc.refcounting-basics.php)\n\n",[[1568082401321,["sirui-php@DESKTOP-PSVFMK8",[[-1,1289,"在查阅有关资料后发现，原来是zval容器结构更新了，"]],[1289,1315],[1289,1289]]],[1568082402252,["sirui-php@DESKTOP-PSVFMK8",[[1,1289,"在查阅有关资料后发现，原来是zval容器结构更新了，"]],[1289,1289],[1289,1315]]],[1568082403212,["sirui-php@DESKTOP-PSVFMK8",[[1,1289,"\n"]],[1289,1289],[1290,1290]]],[1568082403424,["sirui-php@DESKTOP-PSVFMK8",[[1,1290,"\n"]],[1290,1290],[1291,1291]]],[1568082405658,["sirui-php@DESKTOP-PSVFMK8",[[1,1289,"引用次数是_2_，因为同一个变量容器被变量 a 和变量 b关联.当没必要时，php不会去复制已生成的变量容器。变量容器在”refcount“变成0时就被销毁"]],[1289,1289],[1367,1367]]],[1568082412248,["sirui-php@DESKTOP-PSVFMK8",[[-1,1288,"，引用次数是_2_，"]],[1298,1298],[1288,1288]]],[1568082412924,["sirui-php@DESKTOP-PSVFMK8",[[1,1288," "],[-1,1300," a 和变量 "],[1,1307," a 和变量 "]],[1288,1288],[1289,1289]]],[1568082414371,["sirui-php@DESKTOP-PSVFMK8",[[1,1289,"这是"]],[1289,1289],[1291,1291]]],[1568082415542,["sirui-php@DESKTOP-PSVFMK8",[[1,1293,"因为"]],[1291,1291],[1293,1293]]],[1568082416889,["sirui-php@DESKTOP-PSVFMK8",[[-1,1293,"因为"]],[1293,1293],[1293,1293]]],[1568082417815,["sirui-php@DESKTOP-PSVFMK8",[[1,1293,"早"]],[1293,1293],[1294,1294]]],[1568082418249,["sirui-php@DESKTOP-PSVFMK8",[[-1,1293,"早"]],[1294,1294],[1293,1293]]],[1568082421434,["sirui-php@DESKTOP-PSVFMK8",[[1,1293,"在PHP5.x"]],[1293,1293],[1300,1300]]],[1568082426714,["sirui-php@DESKTOP-PSVFMK8",[[1,1300,"版本中"]],[1300,1300],[1303,1303]]],[1568082437978,["sirui-php@DESKTOP-PSVFMK8",[[1,1370,"，er"]],[1370,1370],[1373,1373]]],[1568082438571,["sirui-php@DESKTOP-PSVFMK8",[[-1,1371,"er"]],[1373,1373],[1371,1371]]],[1568082440780,["sirui-php@DESKTOP-PSVFMK8",[[1,1371,"而在新"]],[1371,1371],[1374,1374]]],[1568082441226,["sirui-php@DESKTOP-PSVFMK8",[[-1,1373,"新"]],[1374,1374],[1373,1373]]],[1568082447243,["sirui-php@DESKTOP-PSVFMK8",[[1,1373,"PHP7.x版本中，z"]],[1373,1373],[1384,1384]]],[1568082447683,["sirui-php@DESKTOP-PSVFMK8",[[-1,1383,"z"]],[1384,1384],[1383,1383]]],[1568082448152,["sirui-php@DESKTOP-PSVFMK8",[[1,1383,"ZX"]],[1383,1383],[1385,1385]]],[1568082448641,["sirui-php@DESKTOP-PSVFMK8",[[-1,1384,"X"]],[1385,1385],[1384,1384]]],[1568082449213,["sirui-php@DESKTOP-PSVFMK8",[[1,1384,"val"]],[1384,1384],[1387,1387]]],[1568082451555,["sirui-php@DESKTOP-PSVFMK8",[[-1,1383,"Zval"]],[1387,1387],[1383,1383]]],[1568082460155,["sirui-php@DESKTOP-PSVFMK8",[[1,1383,"zval容器结构发生了更新"]],[1383,1383],[1396,1396]]],[1568082462852,["sirui-php@DESKTOP-PSVFMK8",[[-1,1398,"在查阅有关资料后发现，原来是zval容器结构更新了，"]],[1398,1424],[1398,1398]]],[1568082463002,["sirui-php@DESKTOP-PSVFMK8",[[-1,1399,"\n"]],[1398,1398],[1397,1397]]],[1568082463466,["sirui-php@DESKTOP-PSVFMK8",[[-1,1398,"\n"]],[1397,1397],[1396,1396]]],[1568082465924,["sirui-php@DESKTOP-PSVFMK8",[[1,1396,"，bu"]],[1396,1396],[1399,1399]]],[1568082466556,["sirui-php@DESKTOP-PSVFMK8",[[-1,1397,"bu"]],[1399,1399],[1397,1397]]],[1568082469654,["sirui-php@DESKTOP-PSVFMK8",[[1,1397,"不容与PHP"]],[1397,1397],[1403,1403]]],[1568082470873,["sirui-php@DESKTOP-PSVFMK8",[[-1,1396,"，不容与PHP"]],[1403,1403],[1396,1396]]],[1568082472437,["sirui-php@DESKTOP-PSVFMK8",[[1,1396,"，bu"]],[1396,1396],[1399,1399]]],[1568082473082,["sirui-php@DESKTOP-PSVFMK8",[[-1,1397,"bu"]],[1399,1399],[1397,1397]]],[1568082485556,["sirui-php@DESKTOP-PSVFMK8",[[1,1397,"不同于PHP5.x PHP7.x的zval"]],[1397,1397],[1418,1418]]],[1568082487668,["sirui-php@DESKTOP-PSVFMK8",[[1,1418,"容器"]],[1418,1418],[1420,1420]]],[1568082491164,["sirui-php@DESKTOP-PSVFMK8",[[-1,1397,"不同于PHP5.x PHP7.x的zval容器"]],[1420,1420],[1397,1397]]],[1568082493699,["sirui-php@DESKTOP-PSVFMK8",[[1,1397,"以下"]],[1397,1397],[1399,1399]]],[1568082506690,["sirui-php@DESKTOP-PSVFMK8",[[-1,1396,"，以下"]],[1399,1399],[1396,1396]]],[1568082506996,["sirui-php@DESKTOP-PSVFMK8",[[1,1396,"。"]],[1396,1396],[1397,1397]]],[1568082542593,["sirui-php@DESKTOP-PSVFMK8",[[-1,3045,"`引用文章`"]],[3045,3051],[3045,3045]]],[1568082543066,["sirui-php@DESKTOP-PSVFMK8",[[1,3045," "]],[3045,3045],[3046,3046]]],[1568082553181,["sirui-php@DESKTOP-PSVFMK8",[[1,3046,"[引用文章](#引用文章)"]],[3046,3046],[3059,3059]]],[1568087083975,["sirui-php@DESKTOP-PSVFMK8",[[1,5886,"\n"]],[5885,5885],[5886,5886]]],[1568087086782,["sirui-php@DESKTOP-PSVFMK8",[[1,5885,"haiy"]],[5885,5885],[5889,5889]]],[1568087087416,["sirui-php@DESKTOP-PSVFMK8",[[-1,5885,"haiy"]],[5889,5889],[5885,5885]]],[1568087088187,["sirui-php@DESKTOP-PSVFMK8",[[1,5885,"haiy"]],[5885,5885],[5889,5889]]],[1568087088907,["sirui-php@DESKTOP-PSVFMK8",[[-1,5885,"haiy"]],[5889,5889],[5885,5885]]],[1568087092550,["sirui-php@DESKTOP-PSVFMK8",[[1,5885,"还有一个需要注意点"]],[5885,5885],[5894,5894]]],[1568087093063,["sirui-php@DESKTOP-PSVFMK8",[[-1,5893,"点"]],[5894,5894],[5893,5893]]],[1568087097358,["sirui-php@DESKTOP-PSVFMK8",[[1,5893,"的点，就是在"]],[5893,5893],[5899,5899]]],[1568087097549,["sirui-php@DESKTOP-PSVFMK8",[[-1,5898,"在"]],[5899,5899],[5898,5898]]],[1568087107447,["sirui-php@DESKTOP-PSVFMK8",[[1,5898,"数组的引用计数也有一些特殊的地方，"]],[5898,5898],[5915,5915]]],[1568087126663,["sirui-php@DESKTOP-PSVFMK8",[[1,5915,"这牵扯到 PHP7 中的另一个概念，叫做 `immutable array`（不可变数组）**不可变数组**是 `opcache` 扩展优化出的一种数组类型，简单的说，所有多次编译结果恒定不变的数组，都会被优化为**不可变数组**，下面是一个反例："]],[5915,5915],[6039,6039]]],[1568087130563,["sirui-php@DESKTOP-PSVFMK8",[[1,6041,"\n"]],[6039,6039],[6040,6040]]],[1568087132330,["sirui-php@DESKTOP-PSVFMK8",[[-1,5935," "],[1,5936," "],[-1,5970," "],[1,5971," "],[-1,5980," "],[1,5981," "],[1,6040,"```"]],[6040,6040],[6043,6043]]],[1568087132367,["sirui-php@DESKTOP-PSVFMK8",[[1,6043,"language\n```\n"]],[6043,6043],[6043,6051]]],[1568087132630,["sirui-php@DESKTOP-PSVFMK8",[[-1,6043,"language"],[1,6051,"p"]],[6043,6051],[6044,6044]]],[1568087133815,["sirui-php@DESKTOP-PSVFMK8",[[1,6044,"hp"]],[6044,6044],[6046,6046]]],[1568087134059,["sirui-php@DESKTOP-PSVFMK8",[[1,6047,"\n"]],[6046,6046],[6047,6047]]],[1568087134333,["sirui-php@DESKTOP-PSVFMK8",[[1,6047,"$array = [1, 2, time()];"]],[6047,6047],[6071,6071]]],[1568087135104,["sirui-php@DESKTOP-PSVFMK8",[[-1,6047,"$array = [1, 2, time()];"]],[6071,6071],[6047,6047]]],[1568087135564,["sirui-php@DESKTOP-PSVFMK8",[[1,6047,"  $array = [1, 2, time()];"]],[6047,6047],[6073,6073]]],[1568087139836,["sirui-php@DESKTOP-PSVFMK8",[[1,6079,"PHP 在编译阶段无法得知 `time()` 函数的返回值，所以此处的 $array 是**可变数组**。\n\n**不可变数组**和我们上面讲到的**内部字符串**一样，都是**不使用引用计数**的，但是不同点是，内部字符串的计数值恒为 0，而不可变数组会使用一个**伪计数值** 2。"]],[6079,6079],[6221,6221]]],[1568087141445,["sirui-php@DESKTOP-PSVFMK8",[[1,6222,"\n"]],[6221,6221],[6222,6222]]],[1568087141595,["sirui-php@DESKTOP-PSVFMK8",[[1,6223,"\n"]],[6222,6222],[6223,6223]]],[1568087163279,["sirui-php@DESKTOP-PSVFMK8",[[1,5898,"z"],[-1,6092," "],[1,6093," "],[-1,6101," "],[1,6102," "],[-1,6218," "],[1,6219," "]],[5898,5898],[5899,5899]]],[1568087163679,["sirui-php@DESKTOP-PSVFMK8",[[1,5899,"if"]],[5899,5899],[5901,5901]]],[1568087164231,["sirui-php@DESKTOP-PSVFMK8",[[-1,5898,"zif"]],[5901,5901],[5898,5898]]],[1568087164885,["sirui-php@DESKTOP-PSVFMK8",[[1,5898,"zif"]],[5898,5898],[5901,5901]]],[1568087166717,["sirui-php@DESKTOP-PSVFMK8",[[-1,5898,"zif"]],[5901,5901],[5898,5898]]],[1568087179676,["sirui-php@DESKTOP-PSVFMK8",[[-1,6143,"和我们上面讲到的**内部字符串**一样"]],[6143,6162],[6143,6143]]],[1568087182236,["sirui-php@DESKTOP-PSVFMK8",[[-1,6143,"，都"]],[6145,6145],[6143,6143]]],[1568087186058,["sirui-php@DESKTOP-PSVFMK8",[[-1,6157,"但是不同点是，内部字符串的计数值恒为 0，"]],[6157,6178],[6157,6157]]]],null,"sirui-php@DESKTOP-PSVFMK8"],["ef64958e-398d-4da2-80e5-515a1fa97162",1568097601744,"## 前言\n在学习PHP垃圾回收机制之前先让我们来学习下 `引用计数` 的基本知识，学习 `引用计数` 有助于我们了解垃圾回收机制的原理以及php底层，因为PHP垃圾回收机制就是基于`引用计数`的，在介绍引用计数之前，我曾翻阅过PHP的官方手册，在测试代码的时候发现运行结果与官方手册所写的不符，翻阅相关资料之后发现是官方手册还停留在PH5.x的版本上，而我本地的环境是PHP7.3,所以导致代码结果与官方手册不符，关于为什么不符合，在下文会详细说明，并且会说明引用计数在PHP5.x版本与PHP7.x版本的差异性，当然主要侧重于解释新zval容器中的引用计数机制。\n\n\n## 引用计数基本知识\n\n首先我们先来了解一下 `引用计数`，引用官方文档的一段话： 每个php变量存在一个叫\"zval\"的变量容器中。容器除了包含变量的类型和值，还包括两个字节的额外信息。第一个是\"is_ref\"，是个bool值，用来标识这个变量是否是属于引用集合(reference set)。通过这个字节，php引擎才能把普通变量和引用变量区分开来，由于php允许用户通过使用&来使用自定义引用，zval变量容器中还有一个内部引用计数机制，来优化内存使用。第二个额外字节是\"refcount\"，用以表示指向这个zval变量容器的变量(也称符号即symbol)个数，这是PHP官方手册的一个讲解，而这个手册只适用于PHP5.x版本，我们用代码来演示一下\n\n```php\n$a = 'new string';\n\nxdebug_debug_zval('a');\n\n//打印结果：\n\na: (refcount=1, is_ref=0)='new string'\n```\n\n注意：你需要安装xdebug拓展才可以执行以上代码，使用debug_zval_dump也可以打印出，但是debug_zval_dump打印的结果与xdebug_debug_zval 打印的结果存在差异，具体说明在本文章中不作解释，具体可查看：[PHP xdebug_debug_zval debug_zval_dump 使用](https://blog.csdn.net/pzqingchong/article/details/78004840)\n\n从结果得知，refcount = 1代表有一个变量名指向这个zval容器 is_ref = 0 代表没有存在引用传递，下面我们增加代码，并且分别使用PHP5.6的环境与PHP7.3的环境执行\n\n```php\n$a = 'new string';\n\n$b = $a;\n\nxdebug_debug_zval('a');\n\n//PHP5.6执行结果：\na: (refcount=2, is_ref=0)='new string'\n\n//PHP7.3执行结果：\na: (refcount=1, is_ref=0)='new string'\n```\n\n从结果发现，PHP5.6的refcount发生了变化，数值增加了1，而PHP7.3的结果却没发生过变化，当我们增加变量引用时同样也不会发生变化 这是因为在PHP5.x版本中同一个变量容器被变量 a 和变量 b关联.当没必要时，php不会去复制已生成的变量容器。变量容器在”refcount“变成0时就被销毁，而在PHP7.x版本中，zval容器结构发生了更新。\n\n## Zval容器\n\nPHP5.x版本的Zval容器：\n\n```c\nstruct _zval_struct {\n\tunion {\n\t\tlong lval;\n\t\tdouble dval;\n\t\tstruct {\n\t\t\tchar *val;\n\t\t\tint len;\n\t\t} str;\n\t\tHashTable *ht;\n\t\tzend_object_value obj;\n\t\tzend_ast *ast;\n\t} value;\n\tzend_uint refcount__gc;\n\tzend_uchar type;\n\tzend_uchar is_ref__gc;\n};\n```\n\nPHP7.x版本的Zval容器：\n```c\nstruct _zval_struct {\n\tunion {\n\t\tzend_long         lval;             /* long value */\n\t\tdouble            dval;             /* double value */\n\t\tzend_refcounted  *counted;\n\t\tzend_string      *str;\n\t\tzend_array       *arr;\n\t\tzend_object      *obj;\n\t\tzend_resource    *res;\n\t\tzend_reference   *ref;\n\t\tzend_ast_ref     *ast;\n\t\tzval             *zv;\n\t\tvoid             *ptr;\n\t\tzend_class_entry *ce;\n\t\tzend_function    *func;\n\t\tstruct {\n\t\t\tuint32_t w1;\n\t\t\tuint32_t w2;\n\t\t} ww;\n\t} value;\n    union {\n        struct {\n            ZEND_ENDIAN_LOHI_4(\n                zend_uchar    type,         /* active type */\n                zend_uchar    type_flags,\n                zend_uchar    const_flags,\n                zend_uchar    reserved)     /* call info for EX(This) */\n        } v;\n        uint32_t type_info;\n    } u1;\n    union {\n        uint32_t     var_flags;\n        uint32_t     next;                 /* hash collision chain */\n        uint32_t     cache_slot;           /* literal cache slot */\n        uint32_t     lineno;               /* line number (for ast nodes) */\n        uint32_t     num_args;             /* arguments number for EX(This) */\n        uint32_t     fe_pos;               /* foreach position */\n        uint32_t     fe_iter_idx;          /* foreach iterator index */\n    } u2;\n};\n```\n\n一个全新的容器结构，对于该结构的详细描述可以参考鸟哥的文章，链接在 [引用文章](#引用文章)中会放出来，对比PHP5.x，有几个重要的更新点：\n\n1.  PHP7 中的变量分为**变量名**和**变量值**两部分，分别对应 `zval_struct` 和在其中声明的 `value`*  \n \n说明：这点并不难理解，每个新建的变量都有与其相对应的zval_struct容器，而变量值则存储于容器中的value\n\n![](http://images.linyiyuan.top/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20190910092340.png)\n\n2. `zval_struct.value` 中的 `zend_long` 、`double` 都是**简单数据类型**，能够直接储存具体的值，而其他复杂数据类型储存一个指向其他数据结构的**指针**\n\n说明:  `zend_long` 、`double`  即我们在 PHP 中的**整形**与**浮点型**, 对于 `zval` 在 `value` 字段中能保存下的值，就不会在对他们进行引用计数，**而是在拷贝的时候直接赋值**\n\n3. PHP7 中，引用计数器储存在 `value` 中而不是 `zval_struct`\n4. **NULL**、**布尔型**都属于**没有值**的数据类型（其中布尔型通过 `IS_FALSE` 和 `IS_TRUE` 两个常量来标记），自然也就没有引用计数\n5. **引用**（REFERENCE）变为了一种数据结构而不再只是一个标记位了，它的结构如下：\n\n```c\nstruct _zend_reference {\n    zend_refcounted_h gc;\n    zval              val;\n}\n```\n6. `zend_reference` 作为 `zval_struct` 中包含的一种 `value` 类型，也拥有自己的 `val` 值，这个值是指向一个 `zval_struct.value` 的。他们都拥有自己的**引用计数器**。\n\n    引用计数器用来记录当前有多少 `zval` 指向同一个 `zend_value`。\n\n以上六点就是对zval容器的更新总结，而针对第六点，我们使用代码进行讲解：请看如下代码：\n\n```php\n$a = 'foo'; \n\n$b = &$a;\n\n$c = $a;\n\nxdebug_debug_zval('a');\nxdebug_debug_zval('b');\nxdebug_debug_zval('c');\n```\n\n$a 与 $b 各拥有一个 `zval_struct` 容器，并且其中的 `value` 都指向同一个 `zend_reference` 结构，`zend_reference` 内嵌一个 `val` 结构， 指向同一个 `zend_string`，**字符串的内容**就储存在其中。\n\n而 $c 也拥有一个 `zval_struct`，而它的 value 在初始化的时候可以直接指向上面提到的 `zend_string` ，这样在拷贝时就不会产生复制。\n![](http://images.linyiyuan.top/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20190910094943.png)\n\n然后我们运行代码：\n![](http://images.linyiyuan.top/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20190910095938.png)\n\n从图中不难发现，$a跟$b 的`refcount` 为2，$c为1，我们根据第五点以及第六点可以知道 $a跟$b都指向同一个 `zend_reference` 所以他们的refcount为2  而`zend_reference` 的结构包含gc 其gc 就是` _zend_refcounted_h `的结构体 主要作用是引用计数以及标记变量的类别\n\n```c\ntypedef struct _zend_refcounted_h {\n\tuint32_t         refcount;\t\t\t/* 引用计数 */\n\tunion {\n\t\tstruct {\n\t\t\tZEND_ENDIAN_LOHI_3(\n\t\t\t\tzend_uchar    type,     \n\t\t\t\tzend_uchar    flags,    /* 字符串的类型 */\n\t\t\t\tuint16_t      gc_info   /* 垃圾回收信息 */\n\t\t\t)\n\t\t} v;\n\t\tuint32_t type_info;\n\t} u;\n} zend_refcounted_h;\n```\n\n现在让我们再来看一个例子：\n```php\n$a = 233;\n$b= &a;\n\nxdebug_debug_zval('a');\n```\n\n这段代码相对于上面唯一不同点就是变量值为整数型，我们根据上面第二点可以得出，当`Value`为简单数据类型时 `zval_struct.value`能够直接储存具体的值，而按值拷贝时，会开辟一个新的 `zval_struct` 以同样的方式将值储存到相同数据类型的 value 中，所以 refcount 的值一直都会为 0。 其中整型就属于简单数据类型，那么我们猜测的结果应该是：\n```php\n//猜测结果\na: (refcount=0, is_ref=1)=123\nb: (refcount=0, is_ref=1)=123\n```\n\n然后实际结果：\n```php\n//实际结果\na: (refcount=2, is_ref=1)=123\nb: (refcount=2, is_ref=1)=123\n```\n\n这是因为当使用 `&` 操作符进行引用拷贝时，情况就不一样了：\n1.  PHP 为 `&` 操作符操作的变量申请一个 `zend_reference` 结构\n2.  将 `zend_reference.value` 指向原来的 `zval_struct.value`\n3.  `zval_struct.value` 的数据类型会被修改为 `zend_refrence`\n4.  将 `zval_struct.value` 指向刚刚申请并初始化后的 `zend_reference`\n5.  为新变量申请 `zval_struct` 结构，将他的 `value` 指向刚刚创建的 `zend_reference`\n\n此时：$var_int_1 和 $var_int_2 都拥有一个 `zval_struct` 结构体，并且他们的 `zval_struct.value` 都指向了同一个 `zend_reference` 结构，所以该结构的引用计数器的值为 2。\n\n还有一个需要注意的点，就是数组的引用计数也有一些特殊的地方，这牵扯到 PHP7 中的另一个概念，叫做 `immutable array`（不可变数组）**不可变数组**是 `opcache` 扩展优化出的一种数组类型，简单的说，所有多次编译结果恒定不变的数组，都会被优化为**不可变数组**，下面是一个反例：\n```php\n  $array = [1, 2, time()];\n```\n\nPHP 在编译阶段无法得知 `time()` 函数的返回值，所以此处的 $array 是**可变数组**。\n\n**不可变数组**是**不使用引用计数**的，而不可变数组会使用一个**伪计数值** 2。\n\n\n## 引用文章\n1. [深入理解 PHP7 中全新的 zval 容器和引用计数机制](https://juejin.im/post/5bbf50e86fb9a05ce02a9c19)\n2. [深入理解PHP7之zval](https://github.com/laruence/php7-internal/blob/master/zval.md)\n3. [confusion about php-7 refcount](https://stackoverflow.com/questions/34764119/confusion-about-php-7-refcount)\n4. [PHP引用变量机制(PHP如何处理变量)](https://www.jianshu.com/p/53fcf6128dcd)\n5. [跟厂长学PHP7内核（八）：深入理解字符串的实现](https://blog.csdn.net/enoch612/article/details/82806820)\n6. [引用计数基本知识](http://docs.php.net/manual/zh/features.gc.refcounting-basics.php)\n\n",[[1568097579827,["sirui-php@DESKTOP-PSVFMK8",[[1,4459,"\n"]],[4458,4458],[4459,4459]]],[1568097581947,["sirui-php@DESKTOP-PSVFMK8",[[1,4449,"\n"]],[4449,4449],[4450,4450]]],[1568097582861,["sirui-php@DESKTOP-PSVFMK8",[[-1,4449,"\n"]],[4450,4450],[4449,4449]]],[1568097591180,["sirui-php@DESKTOP-PSVFMK8",[[1,4359,"\n"]],[4359,4359],[4360,4360]]]],null,"sirui-php@DESKTOP-PSVFMK8"]]}